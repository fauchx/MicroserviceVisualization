{"ast":null,"code":"var _jsxFileName = \"C:\\\\visualizacion_microservicios\\\\src\\\\App.js\";\n//************* Imports *****************/\nimport React from 'react';\nimport * as go from 'gojs';\nimport '../node_modules/gojs/extensions/Figures';\nimport { Inspector } from '../node_modules/gojs/extensionsJSM/DataInspector.js';\nimport './css/App.css'; // contains .diagram-component CSS\n//************ Variables ****************/\n\nvar $ = go.GraphObject.make;\nvar myDiagram = $(go.Diagram, \"myDiagramDiv\", {});\nvar nodos = [];\nvar aristas = [];\nvar diagramaCargado = false;\nvar json;\nvar userStory = [];\nvar MSdependencias = [];\nvar inspector; //************ Funciones ****************/\n\nfunction convertir_jsonAnodos(jsonAnodos) {\n  try {\n    nodos = [];\n    aristas = [];\n\n    var _loop = function _loop(i) {\n      MSdependencias = [];\n\n      var _loop2 = function _loop2(j) {\n        nodos = nodos.concat({\n          actor: json[i].userStories[j].actor,\n          componente: \"historia\",\n          dependencies: json[i].userStories[j].dependencies,\n          group: json[i].id,\n          id: json[i].userStories[j].id,\n          key: json[i].userStories[j].id,\n          name: json[i].userStories[j].name,\n          priority: json[i].userStories[j].priority,\n          project: json[i].userStories[j].project,\n          points: json[i].userStories[j].points\n        });\n\n        var _loop3 = function _loop3(k) {\n          aristas = aristas.concat({\n            from: json[i].id,\n            // eslint-disable-next-line\n            to: function () {\n              for (var l = 0; l < Object(json).length; l++) {\n                for (var m = 0; m < Object(json[l].userStories).length; m++) {\n                  if (json[i].userStories[j].dependencies[k] === json[l].userStories[m].id) {\n                    MSdependencias = MSdependencias.concat(json[l].id);\n                    return json[l].id;\n                  }\n                }\n              }\n            }()\n          });\n        };\n\n        for (var k = 0; k < Object(json[i].userStories[j].dependencies).length; k++) {\n          _loop3(k);\n        }\n      };\n\n      for (var j = 0; j < Object(json[i].userStories).length; j++) {\n        _loop2(j);\n      }\n\n      nodos = nodos.concat({\n        coupling_AIS: json[i].coupling_AIS,\n        coupling_ADS: json[i].coupling_ADS,\n        coupling_SIY: json[i].coupling_SIY,\n        cohesion_lack: json[i].cohesion_lack,\n        cohesion_grade: json[i].cohesion_grade,\n        columnas: Math.ceil(Math.sqrt(json[i].userStories.length)),\n        complexity: json[i].complexity,\n        componente: \"microservicio\",\n        dependencies: MSdependencias,\n        isGroup: true,\n        id: json[i].id,\n        key: json[i].id,\n        points: json[i].points,\n        size: 45 + json[i].userStories.length * 12,\n        textoID: 0.23 - (45 + json[i].userStories.length * 12 - 57) * 0.12 / 100,\n        semantic_similarity: json[i].semantic_similarity\n      });\n    };\n\n    for (var i = 0; i < Object(json).length; i++) {\n      _loop(i);\n    }\n\n    ;\n    diagramaCargado = true;\n    init();\n  } catch (error) {\n    alert(\"Archivo incompatible\");\n    diagramaCargado = false;\n\n    if (inspector != null) {\n      inspector.diagram = null;\n    }\n  }\n\n  console.log(diagramaCargado);\n}\n\nfunction convertir_nodosAjson(nodosAjson) {\n  json = [];\n  var hu = [];\n  var microservicios = [];\n  microservicios = nodosAjson.filter(function (item) {\n    return item.componente === 'microservicio';\n  });\n\n  var _loop4 = function _loop4(i) {\n    hu = nodosAjson.filter(function (item) {\n      return item.componente === 'historia' && item.group === microservicios[i].key;\n    });\n    json = json.concat({\n      \"cohesion_lack\": microservicios[i].cohesion_lack,\n      \"cohesion_grade\": microservicios[i].cohesion_grade,\n      \"complexity\": microservicios[i].complexity,\n      \"coupling_AIS\": microservicios[i].coupling_AIS,\n      \"coupling_ADS\": microservicios[i].coupling_ADS,\n      \"coupling_SIY\": microservicios[i].coupling_SIY,\n      \"id\": microservicios[i].key,\n      \"points\": microservicios[i].points,\n      \"semantic_similarity\": microservicios[i].semantic_similarity,\n      \"userStories\": hu\n    });\n  };\n\n  for (var i = 0; i < Object(microservicios).length; i++) {\n    _loop4(i);\n  }\n} // Show the primary selection's data, or blanks if no Part is selected:\n// eslint-disable-next-line\n\n\ninspector = new Inspector('myInspectorDiv', myDiagram, {\n  //showAllProperties: true,\n  // Inspect the named properties below instead of all properties on each object \n  includesOwnProperties: false,\n  properties: {\n    // key would be automatically added for nodes, but we want to declare it read-only also:\n    \"id\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n      /*show: function (data, propname) {\n        if (data instanceof go.Part) data = data.data;\n        return typeof data === \"object\" && data[propname] !== undefined;\n      }*/\n\n    },\n    \"points\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"dependencies\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"coupling_AIS\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"coupling_ADS\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"coupling_SIY\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"cohesion_lack\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"cohesion_grade\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"complexity\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"semantic_similarity\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"actor\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"group\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"name\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"priority\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"project\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    }\n  }\n});\nalert(\"hasta aquí todo bien\");\n\nfunction init() {\n  $ = go.GraphObject.make; // set your license key here before creating the diagram: go.Diagram.licenseKey = \"...\";\n\n  myDiagram = $(go.Diagram, \"myDiagramDiv\", {\n    // create a Diagram for the DIV HTML element       \n    \"animationManager.initialAnimationStyle\": go.AnimationManager.AnimateLocations,\n    //autoScale: go.Diagram.Uniform,  // scale always has all content fitting in the viewport\n    // decide what kinds of Parts can be added to a Group or to top-level\n    \"commandHandler.memberValidation\": function commandHandlerMemberValidation(grp, node) {\n      if (grp != null) {\n        // maybe allow dropping groups in diagram's background\n        if (node instanceof go.Group) {\n          // No deja agregar un grupo a otro grupo\n          return false;\n        }\n\n        return true;\n      }\n    },\n    \"undoManager.isEnabled\": true,\n    // Habilita deshacer y rehacer\n    contentAlignment: go.Spot.Center,\n    // Centra el contenido en el viewport (ventana gráfica)\n    isReadOnly: false,\n    // No permite modificar\n    mouseDrop: function mouseDrop(e) {\n      // Devuelve al nodo a su posición original cuando de arrastra afuera\n      var ok = myDiagram.commandHandler.addTopLevelParts(myDiagram.selection, true);\n\n      if (!ok) {\n        myDiagram.currentTool.doCancel();\n      }\n    },\n    mouseDragOver: function mouseDragOver() {\n      myDiagram.currentCursor = \"grabbing\";\n      myDiagram.clearHighlighteds();\n    },\n    click: function click() {\n      myDiagram.currentCursor = \"grabbing\";\n      myDiagram.clearHighlighteds();\n    }\n  });\n  myDiagram.groupTemplate = $(go.Group, \"Vertical\", {\n    // 'Vertical' Pone el nombre del nodo arriba    \n    deletable: false,\n    // No permite borrar el grupo\n    copyable: false,\n    //isActionable: true,\n    handlesDragDropForMembers: true,\n    // don't need to define handlers on Nodes and Links\n    computesBoundsAfterDrag: true // Permite arrastrar la historia fuera del\n    // microservicio sin deformarlo\n\n  }, {\n    mouseOver: function mouseOver(e) {\n      e.diagram.currentCursor = \"grab\";\n    },\n    // Para cambiar el fill (color) cuando el cursor entra o sale\n    mouseEnter: function mouseEnter(e, obj) {\n      var microservicio = obj.findObject(\"MICROSERVICIO\");\n      microservicio.fill = \"rgb(68, 100, 66)\";\n      obj.currentCursor = \"hand\";\n    },\n    mouseLeave: function mouseLeave(e, obj) {\n      var microservicio = obj.findObject(\"MICROSERVICIO\");\n      microservicio.fill = \"rgba(125, 200, 120, .6)\";\n    },\n    click: function click(e, node) {\n      var diagram = node.diagram; // remove any previous highlighting\n\n      diagram.clearHighlighteds(); // highlight all Links and Nodes coming out of a given Node\n\n      diagram.startTransaction(\"highlight\"); //diagram.clearHighlighteds();\n      // for each Link coming out of the Node, set Link.isHighlighted\n\n      node.findLinksOutOf().each(function (l) {\n        l.isHighlighted = true;\n      }); // for each Node destination for the Node, set Node.isHighlighted\n\n      node.findNodesOutOf().each(function (n) {\n        n.isHighlighted = true;\n      });\n      diagram.commitTransaction(\"highlight\");\n    },\n    // what to do when a drag-over or a drag-drop occurs on a Group\n    mouseDragEnter: function mouseDragEnter(e, grp, prev) {\n      if (grp.canAddMembers(grp.diagram.toolManager.draggingTool.draggingParts)) {\n        var shape = grp.findObject(\"MICROSERVICIO\");\n\n        if (shape) {\n          shape.fill = \"chartreuse\";\n        }\n\n        grp.diagram.currentCursor = \"\";\n      } else {\n        grp.diagram.currentCursor = \"no-drop\";\n      }\n    },\n    mouseDragLeave: function mouseDragLeave(e, grp, next) {\n      var shape = grp.findObject(\"MICROSERVICIO\");\n\n      if (shape) {\n        shape.fill = \"rgba(125, 200, 120, .6)\";\n      }\n\n      grp.diagram.currentCursor = \"\";\n    },\n    mouseDrop: function mouseDrop(e, grp) {\n      var ok = grp.addMembers(grp.diagram.selection, true);\n\n      if (!ok) {\n        grp.diagram.currentTool.doCancel();\n        return;\n      }\n\n      convertir_nodosAjson(nodos);\n      nuevoDiagrama();\n    }\n  }, new go.Binding(\"layout\", \"columnas\", function (c) {\n    return $(go.GridLayout, {\n      wrappingColumn: c,\n      // Determina cantidad de columnas\n      cellSize: new go.Size(0, 0),\n      // Determina ancho de columnas\n      spacing: new go.Size(0, 0) // Determina espacio entre columnas\n\n    });\n  }), // Inhabilitar el movimiento de los nodos resaltados:\n  //new go.Binding(\"isActionable\", \"isHighlighted\", function (h) {\n  //return h ? true : false;\n  //}).ofObject(),\n  $(go.Panel, \"Spot\", //$(go.Shape, \"Hexagon\", {\n  $(go.Shape, \"Cube1\", {\n    name: \"MICROSERVICIO\",\n    fill: \"rgba(125, 200, 120, .6)\"\n  }, new go.Binding(\"stroke\", \"isHighlighted\", function (h) {\n    return h ? \"red\" : null;\n  }).ofObject(), new go.Binding(\"stroke\", \"isSelected\", function (h) {\n    return h ? \"rgb(30,144,255)\" : null;\n  }).ofObject(), new go.Binding(\"strokeWidth\", \"isHighlighted\", function (h) {\n    return h ? 2 : 3;\n  }).ofObject(), new go.Binding(\"width\", \"size\"), // Asigna al ancho el valor de size\n  new go.Binding(\"height\", \"size\") // Asigna a la altura el valor de size\n  ), $(go.TextBlock, \"text\", new go.Binding(\"text\", \"key\"), // Asigna al texto el valor de key\n  new go.Binding(\"alignment\", \"textoID\", function (c) {\n    return new go.Spot(0.5, c); // Asigna valor a Y en la posición del\n  })), $(go.Placeholder, {\n    // Centra las HUs en el hexágono del microservicio\n    padding: 1\n  })));\n  myDiagram.nodeTemplate = $(go.Node, \"Auto\", {\n    // 'Auto' Ajusta el tamaño del elemento según sus subelementos. \n    locationSpot: go.Spot.Center,\n    copyable: false,\n    deletable: false // No permite borrar el nodo\n\n  }, {\n    mouseOver: function mouseOver(e, node) {\n      e.diagram.currentCursor = \"grab\";\n    },\n    // Para cambiar el fill (color) cuando el cursor entra o sale\n    mouseEnter: function mouseEnter(e, obj) {\n      var microservicio = obj.findObject(\"HISTORIA\");\n      microservicio.fill = \"gray\";\n      obj.currentCursor = \"hand\";\n    },\n    mouseLeave: function mouseLeave(e, obj) {\n      var microservicio = obj.findObject(\"HISTORIA\");\n      microservicio.fill = \"white\";\n    },\n    click: function click(e, node) {\n      var diagram = node.diagram; // remove any previous highlighting\n\n      diagram.clearHighlighteds();\n    }\n  }, $(go.Shape, \"RoundedRectangle\", {\n    name: \"HISTORIA\",\n    fill: \"white\"\n  }), $(go.TextBlock, \"text\", new go.Binding(\"text\", \"key\") // Asigna al texto el valor de key\n  ));\n  myDiagram.linkTemplate = $(go.Link, {\n    curve: go.Link.Bezier,\n    reshapable: true,\n    deletable: false // No permite borrar la flecha\n\n  }, // No necesita guardar Link.points, por lo que no necesita TwoWay Binding en \"puntos\"\n  new go.Binding(\"curviness\", \"curviness\").makeTwoWay(), // pero guarda \"curvas\" automáticamente\n  $(go.Shape, {\n    // Características del cuerpo de la flecha       \n    strokeWidth: 2\n  }, new go.Binding(\"stroke\", \"isHighlighted\", function (h) {\n    return h ? \"red\" : \"black\";\n  }).ofObject()), $(go.Shape, {\n    // Características de la cabeza de la flecha  \n    toArrow: \"standard\",\n    // Forma de la cabeza de la flecha  \n    stroke: \"white\" // Borde de la cabeza de flecha\n\n  })); // Crea el modelo del diagrama a mostrar\n\n  myDiagram.model = new go.GraphLinksModel(nodos, aristas); // some shared model data\n\n  myDiagram.model.modelData = {\n    test: true,\n    hello: \"world\",\n    version: 42\n  }; // select a Node, so that the first Inspector shows something\n\n  myDiagram.select(myDiagram.nodes.first());\n  /* Declare which properties to show and how.\n  By default, all properties on the model data objects are shown unless \n  the inspector option \"includesOwnProperties\" is set to false. */\n} // end Init\n\n\nexport function LeerArchivo(e) {\n  var archivo = e.target.files[0];\n\n  if (!archivo) {\n    return;\n  }\n\n  if (diagramaCargado) {\n    myDiagram.div = null;\n    myDiagram = null;\n  }\n\n  json = [];\n  var lector = new FileReader();\n\n  lector.onload = function (e) {\n    var jsonData = e.target.result;\n    json = JSON.parse(jsonData);\n    convertir_jsonAnodos(json);\n  };\n\n  lector.readAsText(archivo);\n  document.getElementById(\"miInput\").value = null;\n}\n\nfunction formatearDependencias() {\n  // Quita los nombres de las dependencias y las\n  var dependencias = []; // deja como un arreglo de strings (historias)\n\n  for (var i = 0; i < userStory[0].dependencies.length; i++) {\n    dependencias = dependencias.concat(userStory[0].dependencies[i].id);\n  }\n\n  userStory[0].dependencies = dependencias;\n}\n\nfunction verificarHistoria() {\n  // Verifica la existencia de una historia de usuario \n  var story = userStory[0].id; // en un diagrama de microservicios\n\n  for (var i = 0; i < json.length; i++) {\n    for (var j = 0; j < json[i].userStories.length; j++) {\n      if (json[i].userStories[j].id === story) {\n        alert(\"Este id de historia ya existe\");\n        return true;\n      }\n    }\n  }\n\n  formatearDependencias();\n  return false;\n}\n\nfunction agregarHistoria(e) {\n  if (diagramaCargado) {\n    var archivo = e.target.files[0];\n\n    if (!archivo) {\n      return;\n    }\n\n    var lector = new FileReader();\n\n    lector.onload = function (e) {\n      var userStoryData = e.target.result;\n      userStory = JSON.parse(userStoryData);\n      var existeHistoria = verificarHistoria();\n\n      if (!existeHistoria) {\n        var micro_servicio = prompt(\"En qué microservicio?\");\n\n        for (var i = 0; i < json.length; i++) {\n          if (json[i].id === micro_servicio) {\n            json[i].userStories = json[i].userStories.concat(userStory);\n            nuevoDiagrama();\n            break;\n          }\n        }\n      }\n    };\n\n    lector.readAsText(archivo);\n  } else {\n    alert(\"Cargue un diagrama primero.\");\n  }\n\n  document.getElementById(\"miInput2\").value = null;\n}\n\nfunction exportarJson() {\n  if (diagramaCargado) {\n    console.log(\"Entró a exportar json\");\n    var dataStr = JSON.stringify(json);\n    var dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);\n    var exportFileDefaultName = 'data.json'; // Asigna un nombre al archivo\n\n    var linkElement = document.createElement('a');\n    linkElement.setAttribute('href', dataUri);\n    linkElement.setAttribute('download', exportFileDefaultName);\n    linkElement.click();\n  } else {\n    alert(\"Cargue un diagrama primero\");\n  }\n}\n\nfunction nuevoDiagrama() {\n  if (diagramaCargado === true) {\n    myDiagram.div = null;\n    myDiagram = null;\n  }\n\n  convertir_jsonAnodos(json);\n  diagramaCargado = true;\n} // render function...\n\n\nexport function App() {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 504,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    id: \"spanEncabezado\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 505,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"encabezado\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 506,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"span\", {\n    id: \"spanInspector\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 508,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"InspectorDiv\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 509,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"inputsDiv\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 510,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"file-select\",\n    id: \"src-file1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 511,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    onInput: LeerArchivo,\n    className: \"boton\",\n    type: \"file\",\n    id: \"miInput\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 512,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"file-select\",\n    id: \"src-file2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 514,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    onInput: agregarHistoria,\n    className: \"boton\",\n    type: \"file\",\n    id: \"miInput2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 515,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"file-select\",\n    id: \"src-file3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 517,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: exportarJson,\n    className: \"boton\",\n    type: \"button\",\n    id: \"miInput3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 518,\n      columnNumber: 15\n    }\n  }))), /*#__PURE__*/React.createElement(\"h3\", {\n    id: \"informacion\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 521,\n      columnNumber: 11\n    }\n  }, \"INFORMATION:\"), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"myInspectorDiv\",\n    className: \"inspector\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 522,\n      columnNumber: 11\n    }\n  }))), /*#__PURE__*/React.createElement(\"span\", {\n    id: \"spanDiagram\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 526,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"myDiagramDiv\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 527,\n      columnNumber: 9\n    }\n  })));\n} //function mostrarContenido(contenido) {\n//  var elemento = document.getElementById('contenido-archivo');\n//  elemento.innerHTML = contenido; // Inyecta un contenido a un elemento HTML en la página\n//}\n//<script>\n//addEventListener = {document.addEventListener('change', LeerArchivo, false)}\n//</script>\n//export default App\n// Si se habilita esta línea, se ejecuta la función Init cuando el HTML carga el script\n//window.addEventListener('DOMContentLoaded', Init);\n//export default LeerArchivo;","map":{"version":3,"names":["React","go","Inspector","$","GraphObject","make","myDiagram","Diagram","nodos","aristas","diagramaCargado","json","userStory","MSdependencias","inspector","convertir_jsonAnodos","jsonAnodos","i","j","concat","actor","userStories","componente","dependencies","group","id","key","name","priority","project","points","k","from","to","l","Object","length","m","coupling_AIS","coupling_ADS","coupling_SIY","cohesion_lack","cohesion_grade","columnas","Math","ceil","sqrt","complexity","isGroup","size","textoID","semantic_similarity","init","error","alert","diagram","console","log","convertir_nodosAjson","nodosAjson","hu","microservicios","filter","item","includesOwnProperties","properties","readOnly","show","showIfPresent","AnimationManager","AnimateLocations","grp","node","Group","contentAlignment","Spot","Center","isReadOnly","mouseDrop","e","ok","commandHandler","addTopLevelParts","selection","currentTool","doCancel","mouseDragOver","currentCursor","clearHighlighteds","click","groupTemplate","deletable","copyable","handlesDragDropForMembers","computesBoundsAfterDrag","mouseOver","mouseEnter","obj","microservicio","findObject","fill","mouseLeave","startTransaction","findLinksOutOf","each","isHighlighted","findNodesOutOf","n","commitTransaction","mouseDragEnter","prev","canAddMembers","toolManager","draggingTool","draggingParts","shape","mouseDragLeave","next","addMembers","nuevoDiagrama","Binding","c","GridLayout","wrappingColumn","cellSize","Size","spacing","Panel","Shape","h","ofObject","TextBlock","Placeholder","padding","nodeTemplate","Node","locationSpot","linkTemplate","Link","curve","Bezier","reshapable","makeTwoWay","strokeWidth","toArrow","stroke","model","GraphLinksModel","modelData","test","hello","version","select","nodes","first","LeerArchivo","archivo","target","files","div","lector","FileReader","onload","jsonData","result","JSON","parse","readAsText","document","getElementById","value","formatearDependencias","dependencias","verificarHistoria","story","agregarHistoria","userStoryData","existeHistoria","micro_servicio","prompt","exportarJson","dataStr","stringify","dataUri","encodeURIComponent","exportFileDefaultName","linkElement","createElement","setAttribute","App"],"sources":["C:/visualizacion_microservicios/src/App.js"],"sourcesContent":["//************* Imports *****************/\nimport React from 'react';\nimport * as go from 'gojs';\nimport '../node_modules/gojs/extensions/Figures'\nimport { Inspector } from '../node_modules/gojs/extensionsJSM/DataInspector.js'\nimport './css/App.css';  // contains .diagram-component CSS\n\n//************ Variables ****************/\n\nvar $ = go.GraphObject.make;\nvar myDiagram = $(go.Diagram, \"myDiagramDiv\", {});\nvar nodos = [];\nvar aristas = [];\nvar diagramaCargado = false;\nvar json;\nvar userStory = [];\nvar MSdependencias = [];\nvar inspector;\n\n//************ Funciones ****************/\n\nfunction convertir_jsonAnodos(jsonAnodos) {\n  try {\n    nodos = [];\n    aristas = [];\n    for (let i = 0; i < Object(json).length; i++) {\n      MSdependencias = [];\n      for (let j = 0; j < Object(json[i].userStories).length; j++) {\n        nodos = nodos.concat({\n          actor: json[i].userStories[j].actor,\n          componente: \"historia\",\n          dependencies: json[i].userStories[j].dependencies,\n          group: json[i].id,\n          id: json[i].userStories[j].id,\n          key: json[i].userStories[j].id,\n          name: json[i].userStories[j].name,\n          priority: json[i].userStories[j].priority,\n          project: json[i].userStories[j].project,\n          points: json[i].userStories[j].points\n        });\n        for (let k = 0; k < Object(json[i].userStories[j].dependencies).length; k++) {\n          aristas = aristas.concat({\n            from: json[i].id,\n            // eslint-disable-next-line\n            to: (function () {\n              for (let l = 0; l < Object(json).length; l++) {\n                for (let m = 0; m < Object(json[l].userStories).length; m++) {\n                  if (json[i].userStories[j].dependencies[k] === json[l].userStories[m].id) {\n                    MSdependencias = MSdependencias.concat(json[l].id);\n                    return json[l].id;\n                  }\n                }\n              }\n            })()\n          });\n        }\n      }\n      nodos = nodos.concat({\n        coupling_AIS: json[i].coupling_AIS,\n        coupling_ADS: json[i].coupling_ADS,\n        coupling_SIY: json[i].coupling_SIY,\n        cohesion_lack: json[i].cohesion_lack,\n        cohesion_grade: json[i].cohesion_grade,\n        columnas: Math.ceil(Math.sqrt(json[i].userStories.length)),\n        complexity: json[i].complexity,\n        componente: \"microservicio\",\n        dependencies: MSdependencias,\n        isGroup: true,\n        id: json[i].id,\n        key: json[i].id,\n        points: json[i].points,\n        size: 45 + (json[i].userStories.length * 12),\n        textoID: 0.23 - ((((45 + (json[i].userStories.length * 12)) - 57) * 0.12) / 100),\n        semantic_similarity: json[i].semantic_similarity\n      });\n    };\n    diagramaCargado = true;\n    init();\n  } catch (error) {\n    alert(\"Archivo incompatible\")\n    diagramaCargado = false;\n    if (inspector != null) {\n      inspector.diagram = null;\n    }\n  }\n  console.log(diagramaCargado);\n}\n\nfunction convertir_nodosAjson(nodosAjson) {\n  json = [];\n  var hu = [];\n  var microservicios = [];\n  microservicios = nodosAjson.filter((item) => item.componente === 'microservicio')\n\n  for (let i = 0; i < Object(microservicios).length; i++) {\n    hu = nodosAjson.filter((item) => (\n      item.componente === 'historia' && item.group === microservicios[i].key\n    ))\n    json = json.concat({\n      \"cohesion_lack\": microservicios[i].cohesion_lack,\n      \"cohesion_grade\": microservicios[i].cohesion_grade,\n      \"complexity\": microservicios[i].complexity,\n      \"coupling_AIS\": microservicios[i].coupling_AIS,\n      \"coupling_ADS\": microservicios[i].coupling_ADS,\n      \"coupling_SIY\": microservicios[i].coupling_SIY,\n      \"id\": microservicios[i].key,\n      \"points\": microservicios[i].points,\n      \"semantic_similarity\": microservicios[i].semantic_similarity,\n      \"userStories\": hu\n    });\n  }\n}\n\n// Show the primary selection's data, or blanks if no Part is selected:\n// eslint-disable-next-line\ninspector = new Inspector('myInspectorDiv', myDiagram, {\n  //showAllProperties: true,\n  // Inspect the named properties below instead of all properties on each object \n  includesOwnProperties: false,\n  properties: {\n    // key would be automatically added for nodes, but we want to declare it read-only also:\n    \"id\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n      /*show: function (data, propname) {\n        if (data instanceof go.Part) data = data.data;\n        return typeof data === \"object\" && data[propname] !== undefined;\n      }*/\n    },\n    \"points\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"dependencies\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"coupling_AIS\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"coupling_ADS\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"coupling_SIY\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"cohesion_lack\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"cohesion_grade\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"complexity\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"semantic_similarity\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"actor\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"group\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"name\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"priority\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    },\n    \"project\": {\n      readOnly: true,\n      show: Inspector.showIfPresent\n    }\n  }\n});\n\nalert(\"hasta aquí todo bien\");\n\nfunction init() {\n  $ = go.GraphObject.make;\n  // set your license key here before creating the diagram: go.Diagram.licenseKey = \"...\";\n  myDiagram = $(go.Diagram, \"myDiagramDiv\", { // create a Diagram for the DIV HTML element       \n    \"animationManager.initialAnimationStyle\": go.AnimationManager.AnimateLocations,\n    //autoScale: go.Diagram.Uniform,  // scale always has all content fitting in the viewport\n\n    // decide what kinds of Parts can be added to a Group or to top-level\n    \"commandHandler.memberValidation\": (grp, node) => {\n      if (grp != null) { // maybe allow dropping groups in diagram's background\n        if (node instanceof go.Group) { // No deja agregar un grupo a otro grupo\n          return false;\n        }\n        return true;\n      }\n    },\n    \"undoManager.isEnabled\": true, // Habilita deshacer y rehacer\n    contentAlignment: go.Spot.Center,  // Centra el contenido en el viewport (ventana gráfica)\n    isReadOnly: false,  // No permite modificar\n    mouseDrop: e => { // Devuelve al nodo a su posición original cuando de arrastra afuera\n      const ok = myDiagram.commandHandler.addTopLevelParts(myDiagram.selection, true);\n      if (!ok) {\n        myDiagram.currentTool.doCancel();\n      }\n    },\n    mouseDragOver: function () {\n      myDiagram.currentCursor = \"grabbing\";\n      myDiagram.clearHighlighteds();\n    },\n    click: function () {\n      myDiagram.currentCursor = \"grabbing\";\n      myDiagram.clearHighlighteds();\n    }\n  });\n\n  myDiagram.groupTemplate = $(go.Group, \"Vertical\", { // 'Vertical' Pone el nombre del nodo arriba    \n    deletable: false, // No permite borrar el grupo\n    copyable: false,\n    //isActionable: true,\n    handlesDragDropForMembers: true,  // don't need to define handlers on Nodes and Links\n    computesBoundsAfterDrag: true  // Permite arrastrar la historia fuera del\n    // microservicio sin deformarlo\n\n  },\n    {\n      mouseOver: function (e) {\n        e.diagram.currentCursor = \"grab\";\n      },\n\n      // Para cambiar el fill (color) cuando el cursor entra o sale\n      mouseEnter: function (e, obj) {\n        var microservicio = obj.findObject(\"MICROSERVICIO\");\n        microservicio.fill = \"rgb(68, 100, 66)\";\n        obj.currentCursor = \"hand\";\n      },\n      mouseLeave: function (e, obj) {\n        var microservicio = obj.findObject(\"MICROSERVICIO\");\n        microservicio.fill = \"rgba(125, 200, 120, .6)\";\n      },\n      click: function (e, node) {\n        var diagram = node.diagram;\n        // remove any previous highlighting\n        diagram.clearHighlighteds();\n        // highlight all Links and Nodes coming out of a given Node\n        diagram.startTransaction(\"highlight\");\n        //diagram.clearHighlighteds();\n        // for each Link coming out of the Node, set Link.isHighlighted\n        node.findLinksOutOf().each(function (l) { l.isHighlighted = true; });\n        // for each Node destination for the Node, set Node.isHighlighted\n        node.findNodesOutOf().each(function (n) { n.isHighlighted = true; });\n        diagram.commitTransaction(\"highlight\");\n      },\n\n      // what to do when a drag-over or a drag-drop occurs on a Group\n      mouseDragEnter: (e, grp, prev) => {\n        if (grp.canAddMembers(grp.diagram.toolManager.draggingTool.draggingParts)) {\n          const shape = grp.findObject(\"MICROSERVICIO\");\n          if (shape) {\n            shape.fill = \"chartreuse\";\n          }\n          grp.diagram.currentCursor = \"\";\n        } else {\n          grp.diagram.currentCursor = \"no-drop\";\n        }\n      },\n      mouseDragLeave: (e, grp, next) => {\n        const shape = grp.findObject(\"MICROSERVICIO\");\n        if (shape) {\n          shape.fill = \"rgba(125, 200, 120, .6)\";\n        }\n        grp.diagram.currentCursor = \"\";\n      },\n      mouseDrop: (e, grp) => {\n        const ok = grp.addMembers(grp.diagram.selection, true);\n        if (!ok) {\n          grp.diagram.currentTool.doCancel();\n          return;\n        }\n        convertir_nodosAjson(nodos);\n        nuevoDiagrama();\n      }\n    },\n    new go.Binding(\"layout\", \"columnas\", function (c) {\n      return $(go.GridLayout, {\n        wrappingColumn: c, // Determina cantidad de columnas\n        cellSize: new go.Size(0, 0), // Determina ancho de columnas\n        spacing: new go.Size(0, 0) // Determina espacio entre columnas\n      });\n    }),\n    // Inhabilitar el movimiento de los nodos resaltados:\n    //new go.Binding(\"isActionable\", \"isHighlighted\", function (h) {\n    //return h ? true : false;\n    //}).ofObject(),\n    $(go.Panel, \"Spot\",\n      //$(go.Shape, \"Hexagon\", {\n      $(go.Shape, \"Cube1\", {\n        name: \"MICROSERVICIO\",\n        fill: \"rgba(125, 200, 120, .6)\"\n      },\n        new go.Binding(\"stroke\", \"isHighlighted\", function (h) {\n          return h ? \"red\" : null;\n        }).ofObject(),\n        new go.Binding(\"stroke\", \"isSelected\", function (h) {\n          return h ? \"rgb(30,144,255)\" : null;\n        }).ofObject(),\n        new go.Binding(\"strokeWidth\", \"isHighlighted\", function (h) {\n          return h ? 2 : 3;\n        }).ofObject(),\n        new go.Binding(\"width\", \"size\"), // Asigna al ancho el valor de size\n        new go.Binding(\"height\", \"size\") // Asigna a la altura el valor de size\n      ), $(go.TextBlock, \"text\",\n        new go.Binding(\"text\", \"key\"), // Asigna al texto el valor de key\n        new go.Binding(\"alignment\", \"textoID\", function (c) {\n          return new go.Spot(0.5, c); // Asigna valor a Y en la posición del\n        }),\n      ),\n      $(go.Placeholder, { // Centra las HUs en el hexágono del microservicio\n        padding: 1\n      })\n    )\n  );\n\n  myDiagram.nodeTemplate = $(go.Node, \"Auto\", { // 'Auto' Ajusta el tamaño del elemento según sus subelementos. \n    locationSpot: go.Spot.Center,\n    copyable: false,\n    deletable: false // No permite borrar el nodo\n  },\n    {\n      mouseOver: function (e, node) {\n        e.diagram.currentCursor = \"grab\";\n      },\n\n      // Para cambiar el fill (color) cuando el cursor entra o sale\n      mouseEnter: function (e, obj) {\n        var microservicio = obj.findObject(\"HISTORIA\");\n        microservicio.fill = \"gray\";\n        obj.currentCursor = \"hand\";\n      },\n      mouseLeave: function (e, obj) {\n        var microservicio = obj.findObject(\"HISTORIA\");\n        microservicio.fill = \"white\";\n      },\n      click: function (e, node) {\n        var diagram = node.diagram;\n        // remove any previous highlighting\n        diagram.clearHighlighteds();\n      }\n    },\n    $(go.Shape, \"RoundedRectangle\", {\n      name: \"HISTORIA\",\n      fill: \"white\"\n    }),\n    $(go.TextBlock, \"text\",\n      new go.Binding(\"text\", \"key\") // Asigna al texto el valor de key\n    )\n  );\n\n  myDiagram.linkTemplate = $(go.Link, {\n    curve: go.Link.Bezier,\n    reshapable: true,\n    deletable: false // No permite borrar la flecha\n  },\n    // No necesita guardar Link.points, por lo que no necesita TwoWay Binding en \"puntos\"\n    new go.Binding(\"curviness\", \"curviness\").makeTwoWay(),  // pero guarda \"curvas\" automáticamente\n    $(go.Shape, { // Características del cuerpo de la flecha       \n      strokeWidth: 2,\n    },\n      new go.Binding(\"stroke\", \"isHighlighted\", function (h) {\n        return h ? \"red\" : \"black\";\n      }).ofObject(),\n    ),\n    $(go.Shape, { // Características de la cabeza de la flecha  \n      toArrow: \"standard\", // Forma de la cabeza de la flecha  \n      stroke: \"white\" // Borde de la cabeza de flecha\n    })\n  );\n\n  // Crea el modelo del diagrama a mostrar\n  myDiagram.model = new go.GraphLinksModel(nodos, aristas);\n\n  // some shared model data\n  myDiagram.model.modelData = { test: true, hello: \"world\", version: 42 };\n\n  // select a Node, so that the first Inspector shows something\n  myDiagram.select(myDiagram.nodes.first());\n\n  /* Declare which properties to show and how.\n  By default, all properties on the model data objects are shown unless \n  the inspector option \"includesOwnProperties\" is set to false. */\n\n\n} // end Init\n\nexport function LeerArchivo(e) {\n  var archivo = e.target.files[0];\n  if (!archivo) {\n    return;\n  }\n  if (diagramaCargado) {\n    myDiagram.div = null;\n    myDiagram = null;\n  }\n  json = [];\n  var lector = new FileReader();\n  lector.onload = function (e) {\n    var jsonData = e.target.result;\n    json = JSON.parse(jsonData)\n    convertir_jsonAnodos(json);\n  };\n  lector.readAsText(archivo);\n  document.getElementById(\"miInput\").value = null;\n}\n\nfunction formatearDependencias() { // Quita los nombres de las dependencias y las\n  var dependencias = [];           // deja como un arreglo de strings (historias)\n  for (let i = 0; i < userStory[0].dependencies.length; i++) {\n    dependencias = dependencias.concat(userStory[0].dependencies[i].id);\n  }\n  userStory[0].dependencies = dependencias;\n}\n\nfunction verificarHistoria() {   // Verifica la existencia de una historia de usuario \n  var story = userStory[0].id;   // en un diagrama de microservicios\n  for (let i = 0; i < json.length; i++) {\n    for (let j = 0; j < json[i].userStories.length; j++) {\n      if (json[i].userStories[j].id === story) {\n        alert(\"Este id de historia ya existe\");\n        return true;\n      }\n    }\n  }\n  formatearDependencias();\n  return false;\n}\n\nfunction agregarHistoria(e) {\n  if (diagramaCargado) {\n    var archivo = e.target.files[0];\n    if (!archivo) {\n      return;\n    }\n    var lector = new FileReader();\n    lector.onload = function (e) {\n      var userStoryData = e.target.result;\n      userStory = JSON.parse(userStoryData)\n      var existeHistoria = verificarHistoria();\n      if (!existeHistoria) {\n        let micro_servicio = prompt(\"En qué microservicio?\");\n        for (let i = 0; i < json.length; i++) {\n          if (json[i].id === micro_servicio) {\n            json[i].userStories = json[i].userStories.concat(userStory);\n            nuevoDiagrama();\n            break;\n          }\n        }\n      }\n    };\n    lector.readAsText(archivo);\n  } else {\n    alert(\"Cargue un diagrama primero.\")\n  }\n  document.getElementById(\"miInput2\").value = null;\n}\n\nfunction exportarJson() {\n  if (diagramaCargado) {\n    console.log(\"Entró a exportar json\")\n    let dataStr = JSON.stringify(json);\n    let dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);\n\n    let exportFileDefaultName = 'data.json'; // Asigna un nombre al archivo\n\n    let linkElement = document.createElement('a');\n    linkElement.setAttribute('href', dataUri);\n    linkElement.setAttribute('download', exportFileDefaultName);\n    linkElement.click();\n  } else {\n    alert(\"Cargue un diagrama primero\");\n  }\n}\n\nfunction nuevoDiagrama() {\n  if (diagramaCargado === true) {\n    myDiagram.div = null;\n    myDiagram = null;\n  }\n  convertir_jsonAnodos(json);\n  diagramaCargado = true;\n}\n\n// render function...\nexport function App() {\n  return (\n    <div>\n      <span id='spanEncabezado'>\n        <div id=\"encabezado\"></div>\n      </span>\n      <span id='spanInspector'>\n        <div id=\"InspectorDiv\">\n          <div id='inputsDiv'>\n            <div className=\"file-select\" id=\"src-file1\" >\n              <input onInput={LeerArchivo} className='boton' type=\"file\" id='miInput' />\n            </div>\n            <div className=\"file-select\" id=\"src-file2\" >\n              <input onInput={agregarHistoria} className='boton' type=\"file\" id='miInput2' />\n            </div>\n            <div className=\"file-select\" id=\"src-file3\" >\n              <button onClick={exportarJson} className='boton' type=\"button\" id='miInput3' />\n            </div>\n          </div>\n          <h3 id=\"informacion\">INFORMATION:</h3>\n          <div id=\"myInspectorDiv\" className=\"inspector\">\n          </div>\n        </div>\n      </span>\n      <span id='spanDiagram'>\n        <div id='myDiagramDiv'></div>\n      </span>\n    </div>\n  );\n}\n\n//function mostrarContenido(contenido) {\n//  var elemento = document.getElementById('contenido-archivo');\n//  elemento.innerHTML = contenido; // Inyecta un contenido a un elemento HTML en la página\n//}\n\n//<script>\n//addEventListener = {document.addEventListener('change', LeerArchivo, false)}\n//</script>\n\n\n//export default App\n\n// Si se habilita esta línea, se ejecuta la función Init cuando el HTML carga el script\n//window.addEventListener('DOMContentLoaded', Init);\n\n//export default LeerArchivo;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}