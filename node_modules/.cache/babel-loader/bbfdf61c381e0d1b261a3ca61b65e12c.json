{"ast":null,"code":"var _jsxFileName = \"C:\\\\visualizacion_microservicios\\\\src\\\\App.js\";\n//************* Imports *****************/\nimport React from 'react';\nimport * as go from 'gojs';\nimport '../node_modules/gojs/extensions/Figures';\nimport { Inspector } from '../node_modules/gojs/extensionsJSM/DataInspector';\nimport './CSS/App.css'; // contains .diagram-component CSS\n//************ Variables ****************/\n\nvar myDiagram;\nvar nodos = [];\nvar aristas = [];\nvar diagramaCargado = false;\nvar json;\nvar userStory = [];\nvar lastStroked = null; // Recuerda la última forma resaltada\n//************ Funciones ****************/\n\n/**\n * Diagram initialization method, which is passed to the ReactDiagram component.\n * This method is responsible for making the diagram and initializing the model and any templates.\n * The model's data should not be set here, as the ReactDiagram component handles that via the other props.\n */\n\nfunction mouseEnter(e, obj) {\n  var shape = obj.findObject(\"SHAPE\");\n  shape.fill = \"#6DAB80\";\n  shape.stroke = \"#A6E6A1\";\n  var text = obj.findObject(\"TEXT\");\n  text.stroke = \"white\";\n}\n\n;\n\nfunction mouseLeave(e, obj) {\n  var shape = obj.findObject(\"SHAPE\"); // Return the Shape's fill and stroke to the defaults\n\n  shape.fill = obj.data.color;\n  shape.stroke = null; // Return the TextBlock's stroke to its default\n\n  var text = obj.findObject(\"TEXT\");\n  text.stroke = \"black\";\n}\n\n;\n\nfunction convertir_jsonAnodos(jsonAnodos) {\n  nodos = [];\n  aristas = [];\n\n  var _loop = function _loop(i) {\n    nodos = nodos.concat({\n      coupling_AIS: json[i].coupling_AIS,\n      coupling_ADS: json[i].coupling_ADS,\n      coupling_SIY: json[i].coupling_SIY,\n      cohesion_lack: json[i].cohesion_lack,\n      cohesion_grade: json[i].cohesion_grade,\n      columnas: Math.ceil(Math.sqrt(json[i].userStories.length)),\n      complexity: json[i].complexity,\n      componente: \"microservicio\",\n      isGroup: true,\n      id: json[i].id,\n      key: json[i].id,\n      points: json[i].points,\n      size: 45 + json[i].userStories.length * 12,\n      textoID: 0.23 - (45 + json[i].userStories.length * 12 - 57) * 0.12 / 100,\n      semantic_similarity: json[i].semantic_similarity\n    });\n\n    var _loop2 = function _loop2(j) {\n      nodos = nodos.concat({\n        actor: json[i].userStories[j].actor,\n        componente: \"historia\",\n        dependencies: json[i].userStories[j].dependencies,\n        group: json[i].id,\n        id: json[i].userStories[j].id,\n        key: json[i].userStories[j].id,\n        name: json[i].userStories[j].name,\n        priority: json[i].userStories[j].priority,\n        project: json[i].userStories[j].project,\n        points: json[i].userStories[j].points\n      });\n\n      var _loop3 = function _loop3(k) {\n        aristas = aristas.concat({\n          from: json[i].id,\n          // eslint-disable-next-line\n          to: function () {\n            for (var l = 0; l < Object(json).length; l++) {\n              for (var m = 0; m < Object(json[l].userStories).length; m++) {\n                if (json[i].userStories[j].dependencies[k] === json[l].userStories[m].id) {\n                  return json[l].id;\n                }\n              }\n            }\n          }()\n        });\n      };\n\n      for (var k = 0; k < Object(json[i].userStories[j].dependencies).length; k++) {\n        _loop3(k);\n      }\n    };\n\n    for (var j = 0; j < Object(json[i].userStories).length; j++) {\n      _loop2(j);\n    }\n  };\n\n  for (var i = 0; i < Object(json).length; i++) {\n    _loop(i);\n  }\n\n  ;\n  init();\n}\n\nfunction convertir_nodosAjson(nodosAjson) {\n  var hu = [];\n  var microservicios = [];\n  microservicios = nodosAjson.filter(function (item) {\n    return item.componente === 'microservicio';\n  });\n  json = [];\n\n  var _loop4 = function _loop4(i) {\n    hu = nodosAjson.filter(function (item) {\n      return item.componente === 'historia' && item.group === microservicios[i].key;\n    });\n    json = json.concat({\n      \"cohesion_lack\": microservicios[i].cohesion_lack,\n      \"cohesion_grade\": microservicios[i].cohesion_grade,\n      \"complexity\": microservicios[i].complexity,\n      \"coupling_AIS\": microservicios[i].coupling_AIS,\n      \"coupling_ADS\": microservicios[i].coupling_ADS,\n      \"coupling_SIY\": microservicios[i].coupling_SIY,\n      \"id\": microservicios[i].key,\n      \"points\": microservicios[i].points,\n      \"semantic_similarity\": microservicios[i].semantic_similarity,\n      \"userStories\": hu\n    });\n  };\n\n  for (var i = 0; i < Object(microservicios).length; i++) {\n    _loop4(i);\n  }\n\n  nuevoDiagrama();\n}\n\nfunction init() {\n  var $ = go.GraphObject.make; // set your license key here before creating the diagram: go.Diagram.licenseKey = \"...\";\n\n  myDiagram = $(go.Diagram, \"myDiagramDiv\", {\n    // create a Diagram for the DIV HTML element       \n    \"animationManager.initialAnimationStyle\": go.AnimationManager.AnimateLocations,\n    //autoScale: go.Diagram.Uniform,  // scale always has all content fitting in the viewport\n    //isReadOnly: false,  // No permite modificar\n    mouseDrop: function mouseDrop(e) {\n      // Devuelve al nodo a su posición original cuando de arrastra afuera\n      var ok = myDiagram.commandHandler.addTopLevelParts(myDiagram.selection, true);\n\n      if (!ok) {\n        myDiagram.currentTool.doCancel();\n      }\n    },\n    // decide what kinds of Parts can be added to a Group or to top-level\n    \"commandHandler.memberValidation\": function commandHandlerMemberValidation(grp, node) {\n      if (grp != null) {\n        // maybe allow dropping groups in diagram's background\n        if (node instanceof go.Group) {\n          // No deja agregar un grupo a otro grupo\n          return false;\n        }\n\n        return true;\n      }\n    },\n    \"undoManager.isEnabled\": true,\n    // Para hacer debug en consola del navegador\n    contentAlignment: go.Spot.Center,\n    // Centra el contenido en el viewport (ventana gráfica)\n    isReadOnly: false // No permite modificar\n\n  });\n  myDiagram.nodeTemplate = $(go.Node, \"Auto\", {\n    // 'Auto' Ajusta el tamaño del elemento según sus subelementos. \n    locationSpot: go.Spot.Center,\n    copyable: false,\n    deletable: false // No permite borrar el nodo\n\n  }, $(go.Shape, \"RoundedRectangle\", {\n    name: \"HISTORIA\",\n    fill: \"white\"\n  }), $(go.TextBlock, \"text\", new go.Binding(\"text\", \"key\") // Asigna al texto el valor de key\n  ));\n  myDiagram.groupTemplate = $(go.Group, \"Vertical\", {\n    // 'Vertical' Pone el nombre del nodo arriba    \n    mouseEnter: mouseEnter,\n    mouseLeave: mouseLeave,\n    click: function click(e, node) {\n      // highlight all Links and Nodes coming out of a given Node\n      var diagram = node.diagram;\n      diagram.startTransaction(\"highlight\"); // remove any previous highlighting\n\n      diagram.clearHighlighteds(); // for each Link coming out of the Node, set Link.isHighlighted\n\n      node.findLinksOutOf().each(function (l) {\n        l.isHighlighted = true;\n      }); // for each Node destination for the Node, set Node.isHighlighted\n\n      node.findNodesOutOf().each(function (n) {\n        n.isHighlighted = true;\n      });\n      diagram.commitTransaction(\"highlight\");\n    },\n    deletable: false,\n    // No permite borrar el grupo\n    copyable: false,\n    handlesDragDropForMembers: true,\n    // don't need to define handlers on Nodes and Links\n    computesBoundsAfterDrag: true // allow dragging out of a Group that uses a Placeholder\n\n  }, {\n    // what to do when a drag-over or a drag-drop occurs on a Group\n    mouseDragEnter: function mouseDragEnter(e, grp, prev) {\n      if (grp.canAddMembers(grp.diagram.toolManager.draggingTool.draggingParts)) {\n        var shape = grp.findObject(\"MICROSERVICIO\");\n\n        if (shape) {\n          shape.fill = \"chartreuse\";\n        }\n\n        grp.diagram.currentCursor = \"\";\n      } else {\n        grp.diagram.currentCursor = \"no-drop\";\n      }\n    },\n    mouseDragLeave: function mouseDragLeave(e, grp, next) {\n      var shape = grp.findObject(\"MICROSERVICIO\");\n\n      if (shape) {\n        shape.fill = \"rgba(125, 200, 120, .6)\";\n      }\n\n      grp.diagram.currentCursor = \"\";\n    },\n    mouseDrop: function mouseDrop(e, grp) {\n      var ok = grp.addMembers(grp.diagram.selection, true);\n\n      if (!ok) {\n        grp.diagram.currentTool.doCancel();\n        return;\n      }\n\n      convertir_nodosAjson(nodos);\n    } //mouseOver: doMouseOver,  // Este manejador de eventos se define abajo\n\n  }, new go.Binding(\"layout\", \"columnas\", function (c) {\n    return $(go.GridLayout, {\n      wrappingColumn: c,\n      // Determina cantidad de columnas\n      cellSize: new go.Size(0, 0),\n      // Determina ancho de columnas\n      spacing: new go.Size(0, 0) // Determina espacio entre columnas\n\n    });\n  }), $(go.Panel, \"Spot\", //$(go.Shape, \"Hexagon\", {\n  $(go.Shape, \"Cube1\", {\n    name: \"MICROSERVICIO\",\n    strokeWidth: 3,\n    // Ancho del borde\n    stroke: null,\n    // Sin borde\n    fill: \"rgba(125, 200, 120, .6)\"\n  }, new go.Binding(\"stroke\", \"isHighlighted\", function (h) {\n    return h ? \"white\" : \"white\";\n  }).ofObject(), new go.Binding(\"strokeWidth\", \"isHighlighted\", function (h) {\n    return h ? 1 : 3;\n  }).ofObject(), new go.Binding(\"width\", \"size\"), // Asigna al ancho el valor de size\n  new go.Binding(\"height\", \"size\") // Asigna a la altura el valor de size\n  ), $(go.TextBlock, \"text\", new go.Binding(\"text\", \"key\"), // Asigna al texto el valor de key\n  new go.Binding(\"alignment\", \"textoID\", function (c) {\n    return new go.Spot(0.5, c); // Asigna valor a Y en la posición del\n  })), $(go.Placeholder, {\n    // Centra las HUs en el hexágono del microservicio\n    padding: 1\n  })));\n  myDiagram.linkTemplate = $(go.Link, {\n    curve: go.Link.Bezier,\n    reshapable: true,\n    deletable: false // No permite borrar la flecha\n\n  }, // No necesita guardar Link.points, por lo que no necesita TwoWay Binding en \"puntos\"\n  new go.Binding(\"curviness\", \"curviness\").makeTwoWay(), // pero guarda \"curvas\" automáticamente\n  $(go.Shape, {\n    // Características del cuerpo de la flecha       \n    strokeWidth: 2\n  }), $(go.Shape, {\n    // Características de la cabeza de la flecha  \n    toArrow: \"standard\",\n    // Forma de la cabeza de la flecha  \n    stroke: \"white\" // Borde de la cabeza de flecha\n\n  }));\n\n  myDiagram.click = function (e) {\n    e.myDiagram.commit(function (d) {\n      d.clearHighlighteds();\n    }, \"no highlighteds\");\n  }; //onModelChange={handleModelChange}\n\n\n  myDiagram.model = new go.GraphLinksModel(nodos, aristas); // Crea el modelo del diagrama a mostrar\n  //return myDiagram;\n  // Declare which properties to show and how.\n  // By default, all properties on the model data objects are shown unless the inspector option \"includesOwnProperties\" is set to false.\n\n  function doMouseOver(e) {\n    // Llamado cuando el mouse está sobre el fondo del diagrama\n    // Encuentra todos los nodos que están a 1 unidad de distancia    \n    var doc = e.documentPoint;\n    var list = myDiagram.findObjectsNear(doc, 0, null, function (x) {\n      return x instanceof go.Node;\n    }); // Encuentra el que está más cerca de e.documentPoint\n\n    var closest = null;\n    var closestDist = 999999999;\n    list.each(function (node) {\n      var dist = doc.distanceSquaredPoint(node.getDocumentPoint(go.Spot.Center));\n\n      if (dist < closestDist) {\n        closestDist = dist;\n        closest = node;\n      }\n    });\n    showToolTip(closest);\n  } // Llamado con un Nodo (o nulo) cerca o sobre el que eetá el mouse\n\n\n  function showToolTip(obj) {\n    if (obj !== null) {\n      var node = obj.part;\n      var shape = node.findObject(\"MICROSERVICIO\");\n\n      if (shape != null) {\n        shape.stroke = \"white\"; // Pone borde al elemento seleccionado\n      }\n\n      if (lastStroked !== null && lastStroked !== shape) {\n        lastStroked.stroke = null; // Quita el borde del elemento que ya no está seleccionado\n      }\n\n      lastStroked = shape;\n    } else {\n      if (lastStroked !== null) {\n        lastStroked.stroke = null;\n      }\n\n      lastStroked = null;\n    }\n  }\n\n  var diagramDiv = document.getElementById(\"myDiagramDiv\"); // Se asegura de que el cuadro de información esté oculto cuando el mouse no esté sobre el Diagrama\n\n  diagramDiv.addEventListener(\"mouseout\", function (e) {\n    if (lastStroked !== null) {\n      lastStroked.stroke = null;\n    }\n\n    lastStroked = null;\n  }, false); // Show the primary selection's data, or blanks if no Part is selected:\n  // eslint-disable-next-line\n\n  var inspector = new Inspector('myInspectorDiv', myDiagram, {\n    // Inspect the named properties below instead of all properties on each object \n    includesOwnProperties: false,\n    properties: {\n      // key would be automatically added for nodes, but we want to declare it read-only also:\n      \"id\": {\n        readOnly: true,\n        show: function show(data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }\n      },\n      \"coupling_AIS\": {\n        readOnly: true,\n        show: function show(data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }\n      },\n      \"coupling_ADS\": {\n        readOnly: true,\n        show: function show(data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }\n      },\n      \"coupling_SIY\": {\n        readOnly: true,\n        show: function show(data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }\n      },\n      \"cohesion_lack\": {\n        readOnly: true,\n        show: function show(data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }\n      },\n      \"cohesion_grade\": {\n        readOnly: true,\n        show: function show(data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }\n      },\n      \"complexity\": {\n        readOnly: true,\n        show: function show(data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }\n      },\n      \"points\": {\n        readOnly: true,\n        show: function show(data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }\n      },\n      \"semantic_similarity\": {\n        readOnly: true,\n        show: function show(data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }\n      },\n      \"actor\": {\n        readOnly: true,\n        show: function show(data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }\n      },\n      \"dependencies\": {\n        readOnly: true,\n        show: function show(data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }\n      },\n      \"group\": {\n        readOnly: true,\n        show: function show(data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }\n      },\n      \"name\": {\n        readOnly: true,\n        show: function show(data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }\n      },\n      \"priority\": {\n        readOnly: true,\n        show: function show(data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }\n      },\n      \"project\": {\n        readOnly: true,\n        show: function show(data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }\n      }\n    }\n  });\n} // end Init\n\n/**\n * This function handles any changes to the GoJS model.\n * It is here that you would make any updates to your React state, which is dicussed below.\n */\n//function handleModelChange(changes) {\n//  alert('GoJS model changed!');\n//}\n\n\nexport function LeerArchivo(e) {\n  var archivo = e.target.files[0];\n\n  if (!archivo) {\n    return;\n  }\n\n  if (diagramaCargado) {\n    myDiagram.div = null;\n    myDiagram = null;\n  }\n\n  json = [];\n  var lector = new FileReader();\n\n  lector.onload = function (e) {\n    var jsonData = e.target.result;\n    json = JSON.parse(jsonData);\n    convertir_jsonAnodos(json);\n    diagramaCargado = true;\n  };\n\n  lector.readAsText(archivo);\n  document.getElementById(\"miInput\").value = null;\n}\n\nfunction formatearDependencias() {\n  // Quita los nombres de las dependencias y las\n  var dependencias = []; // deja como un arreglo de strings (historias)\n\n  for (var i = 0; i < userStory[0].dependencies.length; i++) {\n    dependencias = dependencias.concat(userStory[0].dependencies[i].id);\n  }\n\n  userStory[0].dependencies = dependencias;\n}\n\nfunction verificarHistoria() {\n  // Verifica la existencia de una historia de usuario \n  var story = userStory[0].id; // en un diagrama de microservicios\n\n  for (var i = 0; i < json.length; i++) {\n    for (var j = 0; j < json[i].userStories.length; j++) {\n      if (json[i].userStories[j].id === story) {\n        alert(\"Este id de historia ya existe\");\n        return true;\n      }\n    }\n  }\n\n  formatearDependencias();\n  return false;\n}\n\nfunction agregarHistoria(e) {\n  if (diagramaCargado) {\n    var archivo = e.target.files[0];\n\n    if (!archivo) {\n      return;\n    }\n\n    var lector = new FileReader();\n\n    lector.onload = function (e) {\n      var userStoryData = e.target.result;\n      userStory = JSON.parse(userStoryData);\n      var existeHistoria = verificarHistoria();\n\n      if (!existeHistoria) {\n        var micro_servicio = prompt(\"En qué microservicio?\");\n\n        for (var i = 0; i < json.length; i++) {\n          if (json[i].id === micro_servicio) {\n            json[i].userStories = json[i].userStories.concat(userStory);\n            nuevoDiagrama();\n            break;\n          }\n        }\n      }\n    };\n\n    lector.readAsText(archivo);\n  } else {\n    alert(\"Cargue un diagrama primero.\");\n  }\n\n  document.getElementById(\"miInput2\").value = null;\n}\n\nfunction nuevoDiagrama() {\n  if (diagramaCargado === true) {\n    myDiagram.div = null;\n    myDiagram = null;\n  }\n\n  convertir_jsonAnodos(json);\n  diagramaCargado = true;\n} // render function...\n\n\nexport function App() {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 531,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    id: \"spanEncabezado\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 532,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"encabezado\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 533,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"span\", {\n    id: \"spanInspector\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 535,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"InspectorDiv\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 536,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"inputsDiv\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 537,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"file-select\",\n    id: \"src-file1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 538,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    onInput: LeerArchivo,\n    className: \"boton\",\n    type: \"file\",\n    id: \"miInput\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 539,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"file-select\",\n    id: \"src-file2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 541,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    onInput: agregarHistoria,\n    className: \"boton\",\n    type: \"file\",\n    id: \"miInput2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 542,\n      columnNumber: 15\n    }\n  }))), /*#__PURE__*/React.createElement(\"h3\", {\n    id: \"informacion\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 545,\n      columnNumber: 11\n    }\n  }, \"INFORMATION:\"), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"myInspectorDiv\",\n    className: \"inspector\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 546,\n      columnNumber: 11\n    }\n  }))), /*#__PURE__*/React.createElement(\"span\", {\n    id: \"spanDiagram\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 550,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"myDiagramDiv\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 551,\n      columnNumber: 9\n    }\n  })));\n} //function mostrarContenido(contenido) {\n//  var elemento = document.getElementById('contenido-archivo');\n//  elemento.innerHTML = contenido; // Inyecta un contenido a un elemento HTML en la página\n//}\n//<script>\n//addEventListener = {document.addEventListener('change', LeerArchivo, false)}\n//</script>\n//export default App\n// Si se habilita esta línea, se ejecuta la función Init cuando el HTML carga el script\n//window.addEventListener('DOMContentLoaded', Init);\n//export default LeerArchivo;","map":{"version":3,"names":["React","go","Inspector","myDiagram","nodos","aristas","diagramaCargado","json","userStory","lastStroked","mouseEnter","e","obj","shape","findObject","fill","stroke","text","mouseLeave","data","color","convertir_jsonAnodos","jsonAnodos","i","concat","coupling_AIS","coupling_ADS","coupling_SIY","cohesion_lack","cohesion_grade","columnas","Math","ceil","sqrt","userStories","length","complexity","componente","isGroup","id","key","points","size","textoID","semantic_similarity","j","actor","dependencies","group","name","priority","project","k","from","to","l","Object","m","init","convertir_nodosAjson","nodosAjson","hu","microservicios","filter","item","nuevoDiagrama","$","GraphObject","make","Diagram","AnimationManager","AnimateLocations","mouseDrop","ok","commandHandler","addTopLevelParts","selection","currentTool","doCancel","grp","node","Group","contentAlignment","Spot","Center","isReadOnly","nodeTemplate","Node","locationSpot","copyable","deletable","Shape","TextBlock","Binding","groupTemplate","click","diagram","startTransaction","clearHighlighteds","findLinksOutOf","each","isHighlighted","findNodesOutOf","n","commitTransaction","handlesDragDropForMembers","computesBoundsAfterDrag","mouseDragEnter","prev","canAddMembers","toolManager","draggingTool","draggingParts","currentCursor","mouseDragLeave","next","addMembers","c","GridLayout","wrappingColumn","cellSize","Size","spacing","Panel","strokeWidth","h","ofObject","Placeholder","padding","linkTemplate","Link","curve","Bezier","reshapable","makeTwoWay","toArrow","commit","d","model","GraphLinksModel","doMouseOver","doc","documentPoint","list","findObjectsNear","x","closest","closestDist","dist","distanceSquaredPoint","getDocumentPoint","showToolTip","part","diagramDiv","document","getElementById","addEventListener","inspector","includesOwnProperties","properties","readOnly","show","propname","Part","undefined","LeerArchivo","archivo","target","files","div","lector","FileReader","onload","jsonData","result","JSON","parse","readAsText","value","formatearDependencias","dependencias","verificarHistoria","story","alert","agregarHistoria","userStoryData","existeHistoria","micro_servicio","prompt","App"],"sources":["C:/visualizacion_microservicios/src/App.js"],"sourcesContent":["//************* Imports *****************/\nimport React from 'react';\nimport * as go from 'gojs';\nimport '../node_modules/gojs/extensions/Figures'\nimport { Inspector } from '../node_modules/gojs/extensionsJSM/DataInspector'\nimport './CSS/App.css';  // contains .diagram-component CSS\n\n//************ Variables ****************/\n\nvar myDiagram;\nvar nodos = [];\nvar aristas = [];\nvar diagramaCargado = false;\nvar json;\nvar userStory = [];\nvar lastStroked = null;  // Recuerda la última forma resaltada\n\n//************ Funciones ****************/\n/**\n * Diagram initialization method, which is passed to the ReactDiagram component.\n * This method is responsible for making the diagram and initializing the model and any templates.\n * The model's data should not be set here, as the ReactDiagram component handles that via the other props.\n */\n\nfunction mouseEnter(e, obj) {\n  var shape = obj.findObject(\"SHAPE\");\n  shape.fill = \"#6DAB80\";\n  shape.stroke = \"#A6E6A1\";\n  var text = obj.findObject(\"TEXT\");\n  text.stroke = \"white\";\n};\n\nfunction mouseLeave(e, obj) {\n  var shape = obj.findObject(\"SHAPE\");\n  // Return the Shape's fill and stroke to the defaults\n  shape.fill = obj.data.color;\n  shape.stroke = null;\n  // Return the TextBlock's stroke to its default\n  var text = obj.findObject(\"TEXT\");\n  text.stroke = \"black\";\n};\n\nfunction convertir_jsonAnodos(jsonAnodos) {\n  nodos = [];\n  aristas = [];\n  for (let i = 0; i < Object(json).length; i++) {\n    nodos = nodos.concat({\n      coupling_AIS: json[i].coupling_AIS,\n      coupling_ADS: json[i].coupling_ADS,\n      coupling_SIY: json[i].coupling_SIY,\n      cohesion_lack: json[i].cohesion_lack,\n      cohesion_grade: json[i].cohesion_grade,\n      columnas: Math.ceil(Math.sqrt(json[i].userStories.length)),\n      complexity: json[i].complexity,\n      componente: \"microservicio\",\n      isGroup: true,\n      id: json[i].id,\n      key: json[i].id,\n      points: json[i].points,\n      size: 45 + (json[i].userStories.length * 12),\n      textoID: 0.23 - ((((45 + (json[i].userStories.length * 12)) - 57) * 0.12) / 100),\n      semantic_similarity: json[i].semantic_similarity\n    });\n    for (let j = 0; j < Object(json[i].userStories).length; j++) {\n      nodos = nodos.concat({\n        actor: json[i].userStories[j].actor,\n        componente: \"historia\",\n        dependencies: json[i].userStories[j].dependencies,\n        group: json[i].id,\n        id: json[i].userStories[j].id,\n        key: json[i].userStories[j].id,\n        name: json[i].userStories[j].name,\n        priority: json[i].userStories[j].priority,\n        project: json[i].userStories[j].project,\n        points: json[i].userStories[j].points\n      });\n      for (let k = 0; k < Object(json[i].userStories[j].dependencies).length; k++) {\n        aristas = aristas.concat({\n          from: json[i].id,\n          // eslint-disable-next-line\n          to: (function () {\n            for (let l = 0; l < Object(json).length; l++) {\n              for (let m = 0; m < Object(json[l].userStories).length; m++) {\n                if (json[i].userStories[j].dependencies[k] === json[l].userStories[m].id) {\n                  return json[l].id;\n                }\n              }\n            }\n          })()\n        });\n      }\n    }\n  };\n  init();\n}\n\nfunction convertir_nodosAjson(nodosAjson) {\n  var hu = [];\n  var microservicios = [];\n  microservicios = nodosAjson.filter((item) => item.componente === 'microservicio')\n\n  json = [];\n  for (let i = 0; i < Object(microservicios).length; i++) {\n    hu = nodosAjson.filter((item) => (item.componente === 'historia' && item.group === microservicios[i].key))\n    json = json.concat({\n      \"cohesion_lack\": microservicios[i].cohesion_lack,\n      \"cohesion_grade\": microservicios[i].cohesion_grade,\n      \"complexity\": microservicios[i].complexity,\n      \"coupling_AIS\": microservicios[i].coupling_AIS,\n      \"coupling_ADS\": microservicios[i].coupling_ADS,\n      \"coupling_SIY\": microservicios[i].coupling_SIY,\n      \"id\": microservicios[i].key,\n      \"points\": microservicios[i].points,\n      \"semantic_similarity\": microservicios[i].semantic_similarity,\n      \"userStories\": hu\n    });\n  }\n  nuevoDiagrama();\n}\n\nfunction init() {\n  const $ = go.GraphObject.make;\n  // set your license key here before creating the diagram: go.Diagram.licenseKey = \"...\";\n  myDiagram = $(go.Diagram, \"myDiagramDiv\", { // create a Diagram for the DIV HTML element       \n    \"animationManager.initialAnimationStyle\": go.AnimationManager.AnimateLocations,\n    //autoScale: go.Diagram.Uniform,  // scale always has all content fitting in the viewport\n    //isReadOnly: false,  // No permite modificar\n    mouseDrop: e => { // Devuelve al nodo a su posición original cuando de arrastra afuera\n      const ok = myDiagram.commandHandler.addTopLevelParts(myDiagram.selection, true);\n      if (!ok) {\n        myDiagram.currentTool.doCancel();\n      }\n    },\n\n    // decide what kinds of Parts can be added to a Group or to top-level\n    \"commandHandler.memberValidation\": (grp, node) => {\n      if (grp != null) { // maybe allow dropping groups in diagram's background\n        if (node instanceof go.Group) { // No deja agregar un grupo a otro grupo\n          return false;\n        }\n        return true;\n      }\n    },\n    \"undoManager.isEnabled\": true, // Para hacer debug en consola del navegador\n    contentAlignment: go.Spot.Center,  // Centra el contenido en el viewport (ventana gráfica)\n    isReadOnly: false  // No permite modificar\n  });\n\n  myDiagram.nodeTemplate = $(go.Node, \"Auto\", { // 'Auto' Ajusta el tamaño del elemento según sus subelementos. \n    locationSpot: go.Spot.Center,\n    copyable: false,\n    deletable: false // No permite borrar el nodo\n  },\n    $(go.Shape, \"RoundedRectangle\", {\n      name: \"HISTORIA\",\n      fill: \"white\"\n    }),\n    $(go.TextBlock, \"text\",\n      new go.Binding(\"text\", \"key\") // Asigna al texto el valor de key\n    )\n  );\n\n  myDiagram.groupTemplate = $(go.Group, \"Vertical\", { // 'Vertical' Pone el nombre del nodo arriba    \n    mouseEnter: mouseEnter,\n    mouseLeave: mouseLeave,\n    click: function (e, node) {\n      // highlight all Links and Nodes coming out of a given Node\n      var diagram = node.diagram;\n      diagram.startTransaction(\"highlight\");\n      // remove any previous highlighting\n      diagram.clearHighlighteds();\n      // for each Link coming out of the Node, set Link.isHighlighted\n      node.findLinksOutOf().each(function (l) { l.isHighlighted = true; });\n      // for each Node destination for the Node, set Node.isHighlighted\n      node.findNodesOutOf().each(function (n) { n.isHighlighted = true; });\n      diagram.commitTransaction(\"highlight\");\n    },\n    deletable: false, // No permite borrar el grupo\n    copyable: false,\n    handlesDragDropForMembers: true,  // don't need to define handlers on Nodes and Links\n    computesBoundsAfterDrag: true  // allow dragging out of a Group that uses a Placeholder\n  },\n    { // what to do when a drag-over or a drag-drop occurs on a Group\n      mouseDragEnter: (e, grp, prev) => {\n        if (grp.canAddMembers(grp.diagram.toolManager.draggingTool.draggingParts)) {\n          const shape = grp.findObject(\"MICROSERVICIO\");\n          if (shape) {\n            shape.fill = \"chartreuse\";\n          }\n          grp.diagram.currentCursor = \"\";\n        } else {\n          grp.diagram.currentCursor = \"no-drop\";\n        }\n      },\n      mouseDragLeave: (e, grp, next) => {\n        const shape = grp.findObject(\"MICROSERVICIO\");\n        if (shape) {\n          shape.fill = \"rgba(125, 200, 120, .6)\";\n        }\n        grp.diagram.currentCursor = \"\";\n      },\n      mouseDrop: (e, grp) => {\n        const ok = grp.addMembers(grp.diagram.selection, true);\n        if (!ok) {\n          grp.diagram.currentTool.doCancel();\n          return;\n        }\n        convertir_nodosAjson(nodos);\n      },\n      //mouseOver: doMouseOver,  // Este manejador de eventos se define abajo\n    },\n    new go.Binding(\"layout\", \"columnas\", function (c) {\n      return $(go.GridLayout, {\n        wrappingColumn: c, // Determina cantidad de columnas\n        cellSize: new go.Size(0, 0), // Determina ancho de columnas\n        spacing: new go.Size(0, 0) // Determina espacio entre columnas\n      });\n    }),\n    $(go.Panel, \"Spot\",\n      //$(go.Shape, \"Hexagon\", {\n      $(go.Shape, \"Cube1\", {\n        name: \"MICROSERVICIO\",\n        strokeWidth: 3, // Ancho del borde\n        stroke: null, // Sin borde\n        fill: \"rgba(125, 200, 120, .6)\"\n      },\n        new go.Binding(\"stroke\", \"isHighlighted\", function (h) {\n          return h ? \"white\" : \"white\";\n        }).ofObject(),\n        new go.Binding(\"strokeWidth\", \"isHighlighted\", function (h) {\n          return h ? 1 : 3;\n        }).ofObject(),\n        new go.Binding(\"width\", \"size\"), // Asigna al ancho el valor de size\n        new go.Binding(\"height\", \"size\") // Asigna a la altura el valor de size\n      ), $(go.TextBlock, \"text\",\n        new go.Binding(\"text\", \"key\"), // Asigna al texto el valor de key\n        new go.Binding(\"alignment\", \"textoID\", function (c) {\n          return new go.Spot(0.5, c); // Asigna valor a Y en la posición del\n        }),\n      ),\n      $(go.Placeholder, { // Centra las HUs en el hexágono del microservicio\n        padding: 1\n      })\n    )\n  );\n\n  myDiagram.linkTemplate = $(go.Link, {\n    curve: go.Link.Bezier,\n    reshapable: true,\n    deletable: false // No permite borrar la flecha\n  },\n    // No necesita guardar Link.points, por lo que no necesita TwoWay Binding en \"puntos\"\n    new go.Binding(\"curviness\", \"curviness\").makeTwoWay(),  // pero guarda \"curvas\" automáticamente\n    $(go.Shape, { // Características del cuerpo de la flecha       \n      strokeWidth: 2\n    }),\n    $(go.Shape, { // Características de la cabeza de la flecha  \n      toArrow: \"standard\", // Forma de la cabeza de la flecha  \n      stroke: \"white\" // Borde de la cabeza de flecha\n    })\n  );\n\n  myDiagram.click = function (e) {\n    e.myDiagram.commit(function (d) { d.clearHighlighteds(); }, \"no highlighteds\");\n  };\n\n  //onModelChange={handleModelChange}\n  myDiagram.model = new go.GraphLinksModel(nodos, aristas); // Crea el modelo del diagrama a mostrar\n  //return myDiagram;\n  // Declare which properties to show and how.\n  // By default, all properties on the model data objects are shown unless the inspector option \"includesOwnProperties\" is set to false.\n\n  function doMouseOver(e) { // Llamado cuando el mouse está sobre el fondo del diagrama\n    // Encuentra todos los nodos que están a 1 unidad de distancia    \n    var doc = e.documentPoint;\n    var list = myDiagram.findObjectsNear(doc, 0, null, x => x instanceof go.Node);\n\n    // Encuentra el que está más cerca de e.documentPoint\n    var closest = null;\n    var closestDist = 999999999;\n    list.each(node => {\n      var dist = doc.distanceSquaredPoint(node.getDocumentPoint(go.Spot.Center));\n      if (dist < closestDist) {\n        closestDist = dist;\n        closest = node;\n      }\n    });\n    showToolTip(closest);\n  }\n\n  // Llamado con un Nodo (o nulo) cerca o sobre el que eetá el mouse\n  function showToolTip(obj) {\n    if (obj !== null) {\n      var node = obj.part;\n      var shape = node.findObject(\"MICROSERVICIO\");\n      if (shape != null) {\n        shape.stroke = \"white\"; // Pone borde al elemento seleccionado\n      }\n      if (lastStroked !== null && lastStroked !== shape) {\n        lastStroked.stroke = null; // Quita el borde del elemento que ya no está seleccionado\n      }\n      lastStroked = shape;\n    } else {\n      if (lastStroked !== null) {\n        lastStroked.stroke = null;\n      }\n      lastStroked = null;\n    }\n  }\n\n  var diagramDiv = document.getElementById(\"myDiagramDiv\");\n\n  // Se asegura de que el cuadro de información esté oculto cuando el mouse no esté sobre el Diagrama\n  diagramDiv.addEventListener(\"mouseout\", e => {\n    if (lastStroked !== null) {\n      lastStroked.stroke = null;\n    }\n    lastStroked = null;\n  }, false);\n\n  // Show the primary selection's data, or blanks if no Part is selected:\n  // eslint-disable-next-line\n  var inspector = new Inspector('myInspectorDiv', myDiagram,\n    {\n      // Inspect the named properties below instead of all properties on each object \n      includesOwnProperties: false,\n      properties: {\n        // key would be automatically added for nodes, but we want to declare it read-only also:\n        \"id\": {\n          readOnly: true,\n          show: function (data, propname) {\n            if (data instanceof go.Part) data = data.data;\n            return typeof data === \"object\" && data[propname] !== undefined;\n          }\n        },\n        \"coupling_AIS\": {\n          readOnly: true,\n          show: function (data, propname) {\n            if (data instanceof go.Part) data = data.data;\n            return typeof data === \"object\" && data[propname] !== undefined;\n          }\n        },\n        \"coupling_ADS\": {\n          readOnly: true,\n          show: function (data, propname) {\n            if (data instanceof go.Part) data = data.data;\n            return typeof data === \"object\" && data[propname] !== undefined;\n          }\n        },\n        \"coupling_SIY\": {\n          readOnly: true,\n          show: function (data, propname) {\n            if (data instanceof go.Part) data = data.data;\n            return typeof data === \"object\" && data[propname] !== undefined;\n          }\n        },\n        \"cohesion_lack\": {\n          readOnly: true,\n          show: function (data, propname) {\n            if (data instanceof go.Part) data = data.data;\n            return typeof data === \"object\" && data[propname] !== undefined;\n          }\n        },\n        \"cohesion_grade\": {\n          readOnly: true,\n          show: function (data, propname) {\n            if (data instanceof go.Part) data = data.data;\n            return typeof data === \"object\" && data[propname] !== undefined;\n          }\n        },\n        \"complexity\": {\n          readOnly: true,\n          show: function (data, propname) {\n            if (data instanceof go.Part) data = data.data;\n            return typeof data === \"object\" && data[propname] !== undefined;\n          }\n        },\n        \"points\": {\n          readOnly: true,\n          show: function (data, propname) {\n            if (data instanceof go.Part) data = data.data;\n            return typeof data === \"object\" && data[propname] !== undefined;\n          }\n        },\n        \"semantic_similarity\": {\n          readOnly: true,\n          show: function (data, propname) {\n            if (data instanceof go.Part) data = data.data;\n            return typeof data === \"object\" && data[propname] !== undefined;\n          }\n        },\n        \"actor\": {\n          readOnly: true,\n          show: function (data, propname) {\n            if (data instanceof go.Part) data = data.data;\n            return typeof data === \"object\" && data[propname] !== undefined;\n          }\n        },\n        \"dependencies\": {\n          readOnly: true,\n          show: function (data, propname) {\n            if (data instanceof go.Part) data = data.data;\n            return typeof data === \"object\" && data[propname] !== undefined;\n          }\n        },\n        \"group\": {\n          readOnly: true,\n          show: function (data, propname) {\n            if (data instanceof go.Part) data = data.data;\n            return typeof data === \"object\" && data[propname] !== undefined;\n          }\n        },\n        \"name\": {\n          readOnly: true,\n          show: function (data, propname) {\n            if (data instanceof go.Part) data = data.data;\n            return typeof data === \"object\" && data[propname] !== undefined;\n          }\n        },\n        \"priority\": {\n          readOnly: true,\n          show: function (data, propname) {\n            if (data instanceof go.Part) data = data.data;\n            return typeof data === \"object\" && data[propname] !== undefined;\n          }\n        },\n        \"project\": {\n          readOnly: true,\n          show: function (data, propname) {\n            if (data instanceof go.Part) data = data.data;\n            return typeof data === \"object\" && data[propname] !== undefined;\n          }\n        }\n      }\n    });\n} // end Init\n\n\n/**\n * This function handles any changes to the GoJS model.\n * It is here that you would make any updates to your React state, which is dicussed below.\n */\n//function handleModelChange(changes) {\n//  alert('GoJS model changed!');\n//}\n\nexport function LeerArchivo(e) {\n  var archivo = e.target.files[0];\n  if (!archivo) {\n    return;\n  }\n  if (diagramaCargado) {\n    myDiagram.div = null;\n    myDiagram = null;\n  }\n  json = [];\n  var lector = new FileReader();\n  lector.onload = function (e) {\n    var jsonData = e.target.result;\n    json = JSON.parse(jsonData)\n    convertir_jsonAnodos(json);\n    diagramaCargado = true;\n  };\n  lector.readAsText(archivo);\n  document.getElementById(\"miInput\").value = null;\n}\n\nfunction formatearDependencias() { // Quita los nombres de las dependencias y las\n  var dependencias = []; // deja como un arreglo de strings (historias)\n  for (let i = 0; i < userStory[0].dependencies.length; i++) {\n    dependencias = dependencias.concat(userStory[0].dependencies[i].id);\n  }\n  userStory[0].dependencies = dependencias;\n}\n\nfunction verificarHistoria() {   // Verifica la existencia de una historia de usuario \n  var story = userStory[0].id; // en un diagrama de microservicios\n  for (let i = 0; i < json.length; i++) {\n    for (let j = 0; j < json[i].userStories.length; j++) {\n      if (json[i].userStories[j].id === story) {\n        alert(\"Este id de historia ya existe\");\n        return true;\n      }\n    }\n  }\n  formatearDependencias();\n  return false;\n}\n\nfunction agregarHistoria(e) {\n  if (diagramaCargado) {\n    var archivo = e.target.files[0];\n    if (!archivo) {\n      return;\n    }\n    var lector = new FileReader();\n    lector.onload = function (e) {\n      var userStoryData = e.target.result;\n      userStory = JSON.parse(userStoryData)\n      var existeHistoria = verificarHistoria();\n      if (!existeHistoria) {\n        let micro_servicio = prompt(\"En qué microservicio?\");\n        for (let i = 0; i < json.length; i++) {\n          if (json[i].id === micro_servicio) {\n            json[i].userStories = json[i].userStories.concat(userStory);\n            nuevoDiagrama();\n            break;\n          }\n        }\n      }\n    };\n    lector.readAsText(archivo);\n  } else {\n    alert(\"Cargue un diagrama primero.\")\n  }\n  document.getElementById(\"miInput2\").value = null;\n}\n\nfunction nuevoDiagrama() {\n  if (diagramaCargado === true) {\n    myDiagram.div = null;\n    myDiagram = null;\n  }\n  convertir_jsonAnodos(json);\n  diagramaCargado = true;\n}\n\n// render function...\nexport function App() {\n  return (\n    <div>\n      <span id='spanEncabezado'>\n        <div id=\"encabezado\"></div>\n      </span>\n      <span id='spanInspector'>\n        <div id=\"InspectorDiv\">\n          <div id='inputsDiv'>\n            <div className=\"file-select\" id=\"src-file1\" >\n              <input onInput={LeerArchivo} className='boton' type=\"file\" id='miInput' />\n            </div>\n            <div className=\"file-select\" id=\"src-file2\" >\n              <input onInput={agregarHistoria} className='boton' type=\"file\" id='miInput2' />\n            </div>\n          </div>\n          <h3 id=\"informacion\">INFORMATION:</h3>\n          <div id=\"myInspectorDiv\" className=\"inspector\">\n          </div>\n        </div>\n      </span>\n      <span id='spanDiagram'>\n        <div id='myDiagramDiv'></div>\n      </span>\n    </div>\n  );\n}\n\n//function mostrarContenido(contenido) {\n//  var elemento = document.getElementById('contenido-archivo');\n//  elemento.innerHTML = contenido; // Inyecta un contenido a un elemento HTML en la página\n//}\n\n//<script>\n//addEventListener = {document.addEventListener('change', LeerArchivo, false)}\n//</script>\n\n\n//export default App\n\n// Si se habilita esta línea, se ejecuta la función Init cuando el HTML carga el script\n//window.addEventListener('DOMContentLoaded', Init);\n\n//export default LeerArchivo;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}