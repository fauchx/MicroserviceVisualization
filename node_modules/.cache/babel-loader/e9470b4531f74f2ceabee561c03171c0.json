{"ast":null,"code":"var _jsxFileName = \"C:\\\\visualizacion_microservicios\\\\src\\\\App.js\";\n//************* Imports *****************/\nimport React from 'react';\nimport * as go from 'gojs';\nimport '../node_modules/gojs/extensions/Figures';\nimport { Inspector } from '../node_modules/gojs/extensionsJSM/DataInspector.js';\nimport './css/App.css'; // contains .diagram-component CSS\n\nimport swal from 'sweetalert'; //************ Variables ****************/\n\nvar myDiagram;\nvar nodos = [];\nvar aristas = [];\nvar diagramaCargado = false;\nvar json;\nvar userStory = [];\nvar proximoMS = \"\";\nvar CantidadMSs = 0;\nvar AIST = 0; // Acoplamiento AIS total\n\nvar ADST = 0; // Acoplamiento ADS total\n\nvar SIYT = 0; // Acoplamiento SIY total\n\nvar CpT = 0; // Acoplamiento total de la aplicación\n\nvar Coh = 0; // Cohesion grade total\n\nvar CohT = 0; // Cohesión total de la aplicación\n\nvar WsicT = 0; // mayor número de historias de usuario asociadas a un microservicio\n//var CxT = 0;  // Complejidad cognitiva total de la aplicación\n\nvar SsT = 0; // Similitud semántica total de la aplicación\n\n/*\n𝑀𝑆𝐵𝐴=(𝑀𝑆, 𝑀𝑇 ⃗) \nDonde:\n𝑀𝑆𝐵𝐴 = MicroServices Based Application\nMS es un conjunto de microservicios MS = {ms1, ms2, …, msn} \n𝑀𝑇 ⃗ es un vector de métricas calculadas para MSBA\n\n𝑀𝑇 ⃗=[𝐶𝑝𝑇, 𝐶𝑜ℎ𝑇, 𝑊𝑠𝑖𝑐𝑇, 𝐶𝑥𝑇,(100− 𝑆𝑠𝑇)]\nDonde:\nCpT es el acoplamiento, \nCohT es la cohesión, \nWsicT es el mayor número de historias de usuario asociadas a un microservicio, \nCxT son los puntos de complejidad cognitiva, y \nSsT es la similitud semántica; Las cuales son métricas calculadas para MSBA\n*/\n\n/* Cx = (sum(c𝑔)) + maxMSpoints + (CantidadMSs*WsicT) + (sum(Pf)) + (sum(SIY)) */\n\nvar maxMSpoints = 0; //var Pf = 0; // Número (máximo?) de llamadas secuenciales entre microservicios\n\n/* CxT = Cx / Cxo */\n//************ Funciones ****************/\n\nfunction convertir_jsonAnodos() {\n  AIST = 0;\n  ADST = 0;\n  SIYT = 0;\n  CpT = 0;\n  Coh = 0;\n  CohT = 0;\n  WsicT = 0;\n  SsT = 0;\n  CantidadMSs = 0;\n  maxMSpoints = 0;\n  nodos = [];\n  aristas = [];\n\n  var _loop = function _loop(i) {\n    MSdependencias = [];\n    MScalls = [];\n    MSpuntos = 0;\n\n    var _loop3 = function _loop3(j) {\n      MSpuntos = MSpuntos + json[i].userStories[j].points;\n\n      if (Object(json[i].userStories).length > WsicT) {\n        WsicT = Object(json[i].userStories).length;\n      }\n\n      ;\n      nodos = nodos.concat({\n        actor: json[i].userStories[j].actor,\n        componente: \"historia\",\n        dependencies: json[i].userStories[j].dependencies,\n        group: json[i].id,\n        id: json[i].userStories[j].id,\n        key: json[i].userStories[j].id,\n        name: json[i].userStories[j].name,\n        priority: json[i].userStories[j].priority,\n        project: json[i].userStories[j].project,\n        points: json[i].userStories[j].points\n      });\n\n      var _loop4 = function _loop4(k) {\n        aristas = aristas.concat({\n          from: json[i].id,\n          // eslint-disable-next-line\n          to: function () {\n            for (var l = 0; l < Object(json).length; l++) {\n              for (var m = 0; m < Object(json[l].userStories).length; m++) {\n                if (json[i].userStories[j].dependencies[k] === json[l].userStories[m].id) {\n                  if (json[i].id !== json[l].id) {\n                    // Si son diferentes MS's se asigna el valor a 'to'.\n                    MScalls = MScalls.concat(json[l].id);\n                    return json[l].id;\n                  }\n                }\n              }\n            }\n          }()\n        });\n      };\n\n      for (var k = 0; k < Object(json[i].userStories[j].dependencies).length; k++) {\n        _loop4(k);\n      }\n    };\n\n    for (var j = 0; j < Object(json[i].userStories).length; j++) {\n      _loop3(j);\n    }\n    /* Hacer este filter abajo si se quieren mostrar las dependencias repetidas en el Inspector*/\n    // eslint-disable-next-line\n\n\n    MSdependencias = MScalls.filter(function (item, index) {\n      // Quita las dependencias repetidas\n      return MScalls.indexOf(item) === index;\n    });\n\n    if (json[i].userStories.length !== 0) {\n      CantidadMSs++;\n      nodos = nodos.concat({\n        calls: MScalls.length,\n        cg: 0,\n        coupling_AIS: 0,\n        coupling_ADS: MSdependencias.length,\n        coupling_SIY: 0,\n        cohesion_lack: 0,\n        cohesion_grade: 0,\n        columnas: Math.ceil(Math.sqrt(json[i].userStories.length)),\n        complexity: json[i].complexity,\n        componente: \"microservicio\",\n        dependencies: MSdependencias,\n        // o 'MScalls' si quiere mostrar repetidos \n        isGroup: true,\n        id: json[i].id,\n        key: json[i].id,\n        points: MSpuntos,\n        requests: 0,\n        semantic_similarity: json[i].semantic_similarity,\n        //size: 45 + (json[i].userStories.length * 12),\n        size: 45 + MSpuntos * 12,\n        textoID: 0.23 - (45 + json[i].userStories.length * 12 - 57) * 0.12 / 100,\n        userStories: json[i].userStories.length\n      });\n    }\n\n    ADST = ADST + Math.pow(MSdependencias.length, 2); // Sumatoria de los cuadrados\n  };\n\n  for (var i = 0; i < Object(json).length; i++) {\n    var MSdependencias;\n    var MScalls;\n    var MSpuntos;\n\n    _loop(i);\n  }\n\n  ;\n  var historias = nodos.filter(function (nodo) {\n    return nodo.componente === \"historia\";\n  });\n  historias = historias.map(function (nodo) {\n    return nodo.id;\n  });\n  console.log(historias); // Quitar las aristas con 'to' undefined\n\n  aristas = aristas.filter(function (item) {\n    return item.to !== undefined;\n  });\n  var rendimiento = 0; // Cálculo de los acomplamientos AIS y SIY\n\n  var _loop2 = function _loop2(_i) {\n    if (nodos[_i].componente === \"microservicio\") {\n      LC = CantidadMSs - 1; // Cohesion Lack\n      // Cálculo del acomplamiento AIS (Cantidad de aristas que le entran)\n\n      MSrequests = [];\n      MSimportancia = [];\n\n      for (var j = 0; j < aristas.length; j++) {\n        if (nodos[_i].id === aristas[j].to) {\n          MSrequests = MSrequests.concat(aristas[j].from);\n        }\n      } // eslint-disable-next-line\n\n\n      MSimportancia = MSrequests.filter(function (item, index) {\n        // Quita las importancias\n        return MSrequests.indexOf(item) === index; // repetidas\n      });\n      nodos[_i].requests = MSrequests.length;\n      nodos[_i].coupling_AIS = MSimportancia.length;\n      AIST = AIST + Math.pow(MSimportancia.length, 2); // Sumatoria de los cuadrados\n      // Cálculo del acomplamiento SIY (interdependencias / cantidad de MS's)\n\n      interdependencias = []; // eslint-disable-next-line\n\n      interdepA = nodos[_i].dependencies.filter(function (item, index) {\n        // Quita las depen-\n        return nodos[_i].dependencies.indexOf(item) === index; // dencias(1) repetidas\n      });\n\n      for (var _j = 0; _j < interdepA.length; _j++) {\n        var _loop5 = function _loop5(k) {\n          // Inicia de nuevo en todos los nodos\n          if (nodos[k].componente === \"microservicio\") {\n            // solo los nodos MS's\n            // eslint-disable-next-line\n            interdepB = nodos[k].dependencies.filter(function (item, index) {\n              return nodos[k].dependencies.indexOf(item) === index;\n            }); // Quita las dependencias(2) repetidas\n\n            if (interdepA[_j] === nodos[k].id) {\n              // Compara dependencias(1) con IDs de MS\n              for (var l = 0; l < interdepB.length; l++) {\n                if (interdepB[l] === nodos[_i].id) {\n                  // Compara dependencias(2) con IDs de MS\n                  interdependencias = interdependencias.concat(nodos[k].id);\n                  LC--;\n                }\n              }\n            }\n          }\n        };\n\n        // para comparar cada dependencia(1)\n        for (var k = 0; k < nodos.length; k++) {\n          _loop5(k);\n        }\n      }\n\n      SIY = interdependencias.length / CantidadMSs;\n      nodos[_i].coupling_SIY = SIY.toFixed(2);\n      SIYT = SIYT + Math.pow(SIY, 2); // Sumatoria de los cuadrados\n      // Cálculo de Cohesion Lack  y Grade\n\n      nodos[_i].cohesion_lack = LC;\n      Coh = LC / CantidadMSs;\n      nodos[_i].cohesion_grade = Coh.toFixed(2);\n      CohT = CohT + Math.pow(Coh, 2); // Sumatoria de los cuadrados\n      // Cálculo de la similitud semántica\n\n      SsT = SsT + nodos[_i].semantic_similarity; // Sumatoria previa\n\n      /*        Otros         */\n\n      rendimiento = rendimiento + nodos[_i].calls; // cg = MSpuntos * (MScalls + MSrequests)\n\n      nodos[_i].cg = nodos[_i].points * (nodos[_i].calls + MSrequests.length);\n      console.log(nodos[_i].id + \".cg: \" + nodos[_i].cg.toFixed(2)); //\n\n      if (nodos[_i].points > maxMSpoints) {\n        maxMSpoints = nodos[_i].points;\n      }\n    }\n  };\n\n  for (var _i = 0; _i < nodos.length; _i++) {\n    var LC;\n    var MSrequests;\n    var MSimportancia;\n    var interdependencias;\n    var interdepA;\n    var interdepB;\n    var SIY;\n\n    _loop2(_i);\n  }\n\n  AIST = Math.sqrt(AIST);\n  ADST = Math.sqrt(ADST);\n  SIYT = Math.sqrt(SIYT);\n  CpT = Math.sqrt(Math.pow(AIST, 2) + Math.pow(ADST, 2) + Math.pow(SIYT, 2));\n  CohT = Math.sqrt(CohT);\n  SsT = SsT * (100 / CantidadMSs);\n  /*          Otros           */\n\n  rendimiento = rendimiento / CantidadMSs;\n  console.log(\"Rendimiento: \" + rendimiento.toFixed(2));\n  console.log(\"Max ponits: \" + maxMSpoints.toFixed(2));\n  diagramaCargado = true;\n  init();\n}\n\nfunction convertir_nodosAjson(nodosAjson) {\n  json = [];\n  var hu = [];\n  var microservicios = [];\n  microservicios = nodosAjson.filter(function (item) {\n    return item.componente === 'microservicio';\n  });\n\n  var _loop6 = function _loop6(i) {\n    hu = nodosAjson.filter(function (item) {\n      return item.componente === 'historia' && item.group === microservicios[i].key;\n    });\n    json = json.concat({\n      \"cohesion_lack\": microservicios[i].cohesion_lack,\n      \"cohesion_grade\": microservicios[i].cohesion_grade,\n      \"complexity\": microservicios[i].complexity,\n      \"id\": microservicios[i].key,\n      \"points\": microservicios[i].points,\n      \"semantic_similarity\": microservicios[i].semantic_similarity,\n      \"userStories\": hu\n    });\n  };\n\n  for (var i = 0; i < Object(microservicios).length; i++) {\n    _loop6(i);\n  }\n}\n\nfunction nuevoMSid() {\n  // Retorna un nuevo ID no usado en el diagrama\n  proximoMS = \"\";\n  var MSs = nodos.filter(function (nodo) {\n    return nodo.componente === \"microservicio\";\n  });\n  var nombres = MSs.map(function (nodo) {\n    return nodo.id.replace(\"MS\", \"\");\n  });\n  nombres.sort();\n  var nums = nombres.map(function (str) {\n    return parseInt(str);\n  });\n\n  for (var i = 1; i < nums.length + 2; i++) {\n    if (i !== nums[i - 1]) {\n      proximoMS = \"MS\" + i;\n      return proximoMS;\n    }\n  }\n}\n\nfunction crearMicroservicio(ms, us) {\n  json = json.concat({\n    \"cohesion_lack\": 0,\n    \"cohesion_grade\": 0,\n    \"complexity\": 0,\n    \"id\": ms,\n    \"points\": 0,\n    \"semantic_similarity\": 0,\n    \"userStories\": us\n  });\n}\n\nfunction formatearUS(historia) {\n  var historiaFormateada = [{\n    \"id\": historia.id,\n    \"name\": historia.name,\n    \"actor\": historia.actor,\n    \"points\": historia.points,\n    \"project\": historia.project,\n    \"priority\": historia.priority,\n    \"dependencies\": historia.dependencies\n  }];\n  return historiaFormateada;\n}\n\nfunction quitarUSdeMS(ms, us) {\n  for (var i = 0; i < Object(json).length; i++) {\n    if (json[i].id === ms) {\n      for (var j = 0; j < json[i].userStories.length; j++) {\n        if (json[i].userStories[j].id === us[0].id) {\n          json[i].userStories.splice(j, 1);\n          return;\n        }\n      }\n\n      return;\n    }\n  }\n}\n\nfunction init() {\n  var $ = go.GraphObject.make; // set your license key here before creating the diagram: go.Diagram.licenseKey = \"...\";\n\n  myDiagram = $(go.Diagram, \"myDiagramDiv\", {\n    // create a Diagram for the DIV HTML element       \n    \"animationManager.initialAnimationStyle\": go.AnimationManager.AnimateLocations,\n    //autoScale: go.Diagram.Uniform,  // scale always has all content fitting in the viewport\n    // decide what kinds of Parts can be added to a Group or to top-level\n    \"commandHandler.memberValidation\": function commandHandlerMemberValidation(grp, node) {\n      if (grp != null) {\n        // maybe allow dropping groups in diagram's background\n        if (node instanceof go.Group) {\n          // No deja agregar un grupo a otro grupo\n          return false;\n        }\n\n        return true;\n      }\n    },\n    \"undoManager.isEnabled\": true,\n    // Habilita deshacer y rehacer\n    contentAlignment: go.Spot.Center,\n    // Centra el contenido en el viewport (ventana gráfica)\n    isReadOnly: false,\n    // No permite modificar\n    mouseDrop: function mouseDrop(e, grp) {\n      // Devuelve al nodo a su posición original cuando se arrastra afuera\n      var nodoSeleccionado = myDiagram.selection; // Guarda el US seleccionado\n\n      var nuevaHistoria = formatearUS(nodoSeleccionado.ea.key.qb);\n\n      try {\n        var MSnombre = nodoSeleccionado.ea.key.qb.group; // Nombre del grupo\n\n        var MScompleto = e.diagram.findNodeForKey(MSnombre);\n\n        if (MScompleto.qb.userStories > 1) {\n          var proximo = nuevoMSid(); // Crea un nuevo id de MS no repetido\n\n          quitarUSdeMS(MSnombre, nuevaHistoria);\n          crearMicroservicio(proximo, nuevaHistoria); // Crea nuevo MS y le asigna el id recién creado\n          //convertir_nodosAjson(nodos);\n\n          nuevoDiagrama();\n        } else {\n          myDiagram.currentTool.doCancel();\n        }\n      } catch (error) {}\n    },\n    mouseDragOver: function mouseDragOver() {\n      myDiagram.currentCursor = \"grabbing\";\n      myDiagram.clearHighlighteds();\n    },\n    click: function click() {\n      myDiagram.currentCursor = \"grabbing\";\n      myDiagram.clearHighlighteds();\n    }\n  });\n  myDiagram.groupTemplate = $(go.Group, \"Vertical\", {\n    // 'Vertical' Pone el nombre del nodo arriba    \n    deletable: false,\n    // No permite borrar el grupo\n    copyable: false,\n    //isActionable: true,\n    handlesDragDropForMembers: true,\n    // don't need to define handlers on Nodes and Links\n    computesBoundsAfterDrag: true // Permite arrastrar la historia fuera del\n    // microservicio sin deformarlo\n\n  }, {\n    mouseOver: function mouseOver(e) {\n      e.diagram.currentCursor = \"grab\";\n    },\n    // Para cambiar el fill (color) cuando el cursor entra o sale\n    mouseEnter: function mouseEnter(e, obj) {\n      var microservicio = obj.findObject(\"MICROSERVICIO\");\n      microservicio.fill = \"rgb(68, 100, 66)\";\n      obj.currentCursor = \"hand\";\n    },\n    mouseLeave: function mouseLeave(e, obj) {\n      var microservicio = obj.findObject(\"MICROSERVICIO\");\n      microservicio.fill = \"rgba(125, 200, 120, .6)\";\n    },\n    click: function click(e, node) {\n      var diagram = node.diagram; // remove any previous highlighting\n\n      diagram.clearHighlighteds(); // highlight all Links and Nodes coming out of a given Node\n\n      diagram.startTransaction(\"highlight\"); //diagram.clearHighlighteds();\n      // for each Link coming out of the Node, set Link.isHighlighted\n\n      node.findLinksOutOf().each(function (l) {\n        l.isHighlighted = true;\n      }); // for each Node destination for the Node, set Node.isHighlighted\n\n      node.findNodesOutOf().each(function (n) {\n        n.isHighlighted = true;\n      });\n      diagram.commitTransaction(\"highlight\");\n    },\n    // what to do when a drag-over or a drag-drop occurs on a Group\n    mouseDragEnter: function mouseDragEnter(e, grp, prev) {\n      if (grp.canAddMembers(grp.diagram.toolManager.draggingTool.draggingParts)) {\n        var shape = grp.findObject(\"MICROSERVICIO\");\n\n        if (shape) {\n          shape.fill = \"chartreuse\";\n        }\n\n        grp.diagram.currentCursor = \"\";\n      } else {\n        grp.diagram.currentCursor = \"no-drop\";\n      }\n    },\n    mouseDragLeave: function mouseDragLeave(e, grp, next) {\n      var shape = grp.findObject(\"MICROSERVICIO\");\n\n      if (shape) {\n        shape.fill = \"rgba(125, 200, 120, .6)\";\n      }\n\n      grp.diagram.currentCursor = \"\";\n    },\n    mouseDrop: function mouseDrop(e, grp) {\n      var ok = grp.addMembers(grp.diagram.selection, true);\n\n      if (!ok) {\n        grp.diagram.currentTool.doCancel();\n        return;\n      }\n\n      convertir_nodosAjson(nodos);\n      nuevoDiagrama();\n    }\n  }, new go.Binding(\"layout\", \"columnas\", function (c) {\n    return $(go.GridLayout, {\n      wrappingColumn: c,\n      // Determina cantidad de columnas\n      cellSize: new go.Size(0, 0),\n      // Determina ancho de columnas\n      spacing: new go.Size(0, 0) // Determina espacio entre columnas\n\n    });\n  }), // Inhabilitar el movimiento de los nodos resaltados:\n  //new go.Binding(\"isActionable\", \"isHighlighted\", function (h) {\n  //return h ? true : false;\n  //}).ofObject(),\n  $(go.Panel, \"Spot\", //$(go.Shape, \"Hexagon\", {\n  $(go.Shape, \"Cube1\", {\n    name: \"MICROSERVICIO\",\n    fill: \"rgba(125, 200, 120, .6)\"\n  }, new go.Binding(\"stroke\", \"isHighlighted\", function (h) {\n    return h ? \"red\" : null;\n  }).ofObject(), new go.Binding(\"stroke\", \"isSelected\", function (h) {\n    return h ? \"rgb(30,144,255)\" : null;\n  }).ofObject(), new go.Binding(\"strokeWidth\", \"isHighlighted\", function (h) {\n    return h ? 2 : 3;\n  }).ofObject(), new go.Binding(\"width\", \"size\"), // Asigna al ancho el valor de size\n  new go.Binding(\"height\", \"size\") // Asigna a la altura el valor de size\n  ), $(go.TextBlock, \"text\", new go.Binding(\"text\", \"key\"), // Asigna al texto el valor de key\n  new go.Binding(\"alignment\", \"textoID\", function (c) {\n    return new go.Spot(0.5, c); // Asigna valor a Y en la posición del\n  })), $(go.Placeholder, {\n    // Centra las HUs en el hexágono del microservicio\n    padding: 1\n  })));\n  myDiagram.nodeTemplate = $(go.Node, \"Auto\", {\n    // 'Auto' Ajusta el tamaño del elemento según sus subelementos. \n    locationSpot: go.Spot.Center,\n    copyable: false,\n    deletable: false // No permite borrar el nodo\n\n  }, {\n    mouseOver: function mouseOver(e, node) {\n      e.diagram.currentCursor = \"grab\";\n    },\n    // Para cambiar el fill (color) cuando el cursor entra o sale\n    mouseEnter: function mouseEnter(e, obj) {\n      var microservicio = obj.findObject(\"HISTORIA\");\n      microservicio.fill = \"gray\";\n      obj.currentCursor = \"hand\";\n    },\n    mouseLeave: function mouseLeave(e, obj) {\n      var microservicio = obj.findObject(\"HISTORIA\");\n      microservicio.fill = \"white\";\n    },\n    click: function click(e, node) {\n      var diagram = node.diagram; // remove any previous highlighting\n\n      diagram.clearHighlighteds();\n    }\n  }, $(go.Shape, \"RoundedRectangle\", {\n    name: \"HISTORIA\",\n    fill: \"white\"\n  }), $(go.TextBlock, \"text\", new go.Binding(\"text\", \"key\") // Asigna al texto el valor de key\n  ));\n  myDiagram.linkTemplate = $(go.Link, {\n    curve: go.Link.Bezier,\n    reshapable: true,\n    deletable: false // No permite borrar la flecha\n\n  }, // No necesita guardar Link.points, por lo que no necesita TwoWay Binding en \"puntos\"\n  new go.Binding(\"curviness\", \"curviness\").makeTwoWay(), // pero guarda \"curvas\" automáticamente\n  $(go.Shape, {\n    // Características del cuerpo de la flecha       \n    strokeWidth: 2\n  }, new go.Binding(\"stroke\", \"isHighlighted\", function (h) {\n    return h ? \"red\" : \"black\";\n  }).ofObject()), $(go.Shape, {\n    // Características de la cabeza de la flecha  \n    toArrow: \"standard\",\n    // Forma de la cabeza de la flecha  \n    stroke: \"white\" // Borde de la cabeza de flecha\n\n  })); // Crea el modelo del diagrama a mostrar\n\n  myDiagram.model = new go.GraphLinksModel(nodos, aristas); // some shared model data\n\n  myDiagram.model.modelData = {\n    \"AIST:\": AIST.toFixed(2),\n    \"ADST:\": ADST.toFixed(2),\n    \"SIYT:\": SIYT.toFixed(2),\n    \"CpT:\": CpT.toFixed(2),\n    \"CohT:\": CohT.toFixed(2),\n    \"SsT:\": SsT.toFixed(2),\n    \"WsicT\": WsicT\n  };\n  /* Declare which properties to show and how.\n  By default, all properties on the model data objects are shown unless \n  the inspector option \"includesOwnProperties\" is set to false. */\n  // Show the primary selection's data, or blanks if no Part is selected:\n  // eslint-disable-next-line\n\n  var inspector = new Inspector('myInspectorDiv', myDiagram, {\n    //showAllProperties: true,\n    // Inspect the named properties below instead of all properties on each object \n    includesOwnProperties: false,\n    inspectSelection: true,\n    properties: {\n      // key would be automatically added for nodes, but we want to declare it read-only also:\n      \"id\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n        /*show: function (data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }*/\n\n      },\n      \"points\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"dependencies\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"coupling_AIS\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"coupling_ADS\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"coupling_SIY\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"cohesion_lack\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"cohesion_grade\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"complexity\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"semantic_similarity\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"actor\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"group\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"name\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"priority\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"project\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      }\n    }\n  }); // Always show the model.modelData:\n\n  var inspector2 = new Inspector('myInspectorDiv2', myDiagram, {\n    inspectSelection: false\n  });\n  inspector2.inspectObject(myDiagram.model.modelData);\n} // end Init\n\n\nfunction validarJson(schema, jsonCargado) {\n  var Ajv = require(\"ajv\");\n\n  var ajv = new Ajv({\n    allErrors: true\n  });\n  var validate = ajv.compile(schema);\n  var valid = validate(jsonCargado);\n\n  if (!valid) {\n    console.log(validate.errors);\n    swal({\n      title: \"Invalid schema\",\n      icon: \"error\",\n      timer: 2000\n    });\n    return false;\n  } else {\n    return true;\n  }\n}\n\nexport function LeerArchivo(e) {\n  var archivo = e.target.files[0];\n\n  if (!archivo) {\n    return;\n  }\n\n  if (diagramaCargado) {\n    myDiagram.div = null;\n    myDiagram = null;\n  }\n\n  json = [];\n  var lector = new FileReader();\n\n  lector.onload = function (e) {\n    var jsonData = e.target.result;\n    json = JSON.parse(jsonData);\n\n    var schema = require('./schemas/microservices.json');\n\n    var esValido = validarJson(schema, json);\n\n    if (esValido) {\n      convertir_jsonAnodos();\n    }\n  };\n\n  lector.readAsText(archivo);\n  document.getElementById(\"miInput\").value = null;\n}\n\nfunction formatearDependencias() {\n  // Quita los nombres de las dependencias y las\n  var dependencias = []; // deja como un arreglo de strings (historias)\n\n  for (var i = 0; i < userStory[0].dependencies.length; i++) {\n    dependencias = dependencias.concat(userStory[0].dependencies[i].id);\n  }\n\n  userStory[0].dependencies = dependencias;\n}\n\nfunction verificarHistoria() {\n  // Verifica la existencia de una historia de usuario \n  try {\n    var story = userStory[0].id; // en un diagrama de microservicios\n\n    var contador = 0;\n\n    for (var i = 0; i < json.length; i++) {\n      for (var j = 0; j < json[i].userStories.length; j++) {\n        if (json[i].userStories[j].id === story) {\n          swal({\n            title: \"The story \" + story + \" is already in the project\",\n            text: \"Do you wish to include other stories?\",\n            icon: \"warning\",\n            buttons: ['Cancel', 'Accept']\n          }).then(function (respuesta) {\n            if (respuesta) {\n              swal({\n                title: \"The rest of the stories were included succesfully\",\n                icon: \"success\",\n                timer: 1500\n              });\n            }\n          });\n          contador++;\n        }\n      }\n    }\n\n    if (contador > 0) {\n      return true;\n    }\n\n    formatearDependencias();\n    swal({\n      title: \"Stories included succesfully\",\n      icon: \"success\",\n      timer: 1500\n    });\n    return false;\n  } catch (error) {\n    swal({\n      title: \"Formato de json incompatible\",\n      icon: \"error\",\n      timer: 1500\n    });\n  }\n}\n\nfunction quitarGuionesMedios(us) {\n  for (var i = 0; i < us.length; i++) {\n    us[i].id = us[i].id.replace(\"-\", \"\");\n\n    for (var j = 0; j < us[i].dependencies.length; j++) {\n      us[i].dependencies[j].id = us[i].dependencies[j].id.replace(\"-\", \"\");\n    }\n  }\n\n  return us;\n}\n\nfunction agregarHistoria(e) {\n  if (diagramaCargado) {\n    var archivo = e.target.files[0];\n\n    if (!archivo) {\n      return;\n    }\n\n    var lector = new FileReader();\n\n    lector.onload = function (e) {\n      var userStoryData = e.target.result;\n      userStory = JSON.parse(userStoryData);\n\n      var schema = require('./schemas/userStories.json');\n\n      var esValido = validarJson(schema, userStory);\n\n      if (esValido) {\n        userStory = quitarGuionesMedios(userStory);\n        var existeHistoria = verificarHistoria();\n\n        if (!existeHistoria) {\n          var micro_servicio = nuevoMSid();\n          crearMicroservicio(micro_servicio, userStory);\n          nuevoDiagrama();\n        }\n      }\n    };\n\n    lector.readAsText(archivo);\n  } else {\n    swal({\n      title: \"Cargue un diagrama primero\",\n      icon: \"error\",\n      timer: 2000\n    });\n  }\n\n  document.getElementById(\"miInput2\").value = null;\n}\n\nfunction exportarJson() {\n  if (diagramaCargado) {\n    var dataStr = JSON.stringify(json);\n    var dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);\n    var exportFileDefaultName = 'data.json'; // Asigna un nombre al archivo\n\n    var linkElement = document.createElement('a');\n    linkElement.setAttribute('href', dataUri);\n    linkElement.setAttribute('download', exportFileDefaultName);\n    linkElement.click();\n  } else {\n    swal({\n      title: \"Cargue un diagrama primero\",\n      icon: \"error\",\n      timer: 2000\n    });\n  }\n}\n\nfunction nuevoDiagrama() {\n  if (diagramaCargado === true) {\n    myDiagram.div = null;\n    myDiagram = null;\n  }\n\n  convertir_jsonAnodos();\n  diagramaCargado = true;\n} // render function...\n\n\nexport function App() {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 810,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    id: \"spanEncabezado\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 811,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"encabezado\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 812,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"spanInspector\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 814,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"fondoInspector\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 815,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"inputsDiv\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 816,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"file-select\",\n    id: \"src-file1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 817,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    onInput: LeerArchivo,\n    className: \"boton\",\n    type: \"file\",\n    id: \"miInput\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 818,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"file-select\",\n    id: \"src-file2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 820,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    onInput: agregarHistoria,\n    className: \"boton\",\n    type: \"file\",\n    id: \"miInput2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 821,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"file-select\",\n    id: \"src-file3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 823,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: exportarJson,\n    className: \"boton\",\n    type: \"button\",\n    id: \"miInput3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 824,\n      columnNumber: 15\n    }\n  }))), /*#__PURE__*/React.createElement(\"h3\", {\n    id: \"informacion\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 827,\n      columnNumber: 11\n    }\n  }, \"INFORMATION:\"), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"myInspectorDiv\",\n    className: \"inspector\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 828,\n      columnNumber: 11\n    }\n  }))), /*#__PURE__*/React.createElement(\"span\", {\n    id: \"spanDiagram\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 832,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    id: \"myDiagramDiv\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 833,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"spanInspector\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 835,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"fondoInspector\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 836,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    id: \"informacion\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 837,\n      columnNumber: 11\n    }\n  }, \"APP METRICS:\"), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"myInspectorDiv2\",\n    className: \"inspector\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 838,\n      columnNumber: 11\n    }\n  }))));\n} //function mostrarContenido(contenido) {\n//  var elemento = document.getElementById('contenido-archivo');\n//  elemento.innerHTML = contenido; // Inyecta un contenido a un elemento HTML en la página\n//}\n//<script>\n//addEventListener = {document.addEventListener('change', LeerArchivo, false)}\n//</script>\n//export default App\n// Si se habilita esta línea, se ejecuta la función Init cuando el HTML carga el script\n//window.addEventListener('DOMContentLoaded', Init);\n//export default LeerArchivo;","map":{"version":3,"names":["React","go","Inspector","swal","myDiagram","nodos","aristas","diagramaCargado","json","userStory","proximoMS","CantidadMSs","AIST","ADST","SIYT","CpT","Coh","CohT","WsicT","SsT","maxMSpoints","convertir_jsonAnodos","i","MSdependencias","MScalls","MSpuntos","j","userStories","points","Object","length","concat","actor","componente","dependencies","group","id","key","name","priority","project","k","from","to","l","m","filter","item","index","indexOf","calls","cg","coupling_AIS","coupling_ADS","coupling_SIY","cohesion_lack","cohesion_grade","columnas","Math","ceil","sqrt","complexity","isGroup","requests","semantic_similarity","size","textoID","pow","historias","nodo","map","console","log","undefined","rendimiento","LC","MSrequests","MSimportancia","interdependencias","interdepA","interdepB","SIY","toFixed","init","convertir_nodosAjson","nodosAjson","hu","microservicios","nuevoMSid","MSs","nombres","replace","sort","nums","str","parseInt","crearMicroservicio","ms","us","formatearUS","historia","historiaFormateada","quitarUSdeMS","splice","$","GraphObject","make","Diagram","AnimationManager","AnimateLocations","grp","node","Group","contentAlignment","Spot","Center","isReadOnly","mouseDrop","e","nodoSeleccionado","selection","nuevaHistoria","ea","qb","MSnombre","MScompleto","diagram","findNodeForKey","proximo","nuevoDiagrama","currentTool","doCancel","error","mouseDragOver","currentCursor","clearHighlighteds","click","groupTemplate","deletable","copyable","handlesDragDropForMembers","computesBoundsAfterDrag","mouseOver","mouseEnter","obj","microservicio","findObject","fill","mouseLeave","startTransaction","findLinksOutOf","each","isHighlighted","findNodesOutOf","n","commitTransaction","mouseDragEnter","prev","canAddMembers","toolManager","draggingTool","draggingParts","shape","mouseDragLeave","next","ok","addMembers","Binding","c","GridLayout","wrappingColumn","cellSize","Size","spacing","Panel","Shape","h","ofObject","TextBlock","Placeholder","padding","nodeTemplate","Node","locationSpot","linkTemplate","Link","curve","Bezier","reshapable","makeTwoWay","strokeWidth","toArrow","stroke","model","GraphLinksModel","modelData","inspector","includesOwnProperties","inspectSelection","properties","readOnly","show","showIfPresent","inspector2","inspectObject","validarJson","schema","jsonCargado","Ajv","require","ajv","allErrors","validate","compile","valid","errors","title","icon","timer","LeerArchivo","archivo","target","files","div","lector","FileReader","onload","jsonData","result","JSON","parse","esValido","readAsText","document","getElementById","value","formatearDependencias","dependencias","verificarHistoria","story","contador","text","buttons","then","respuesta","quitarGuionesMedios","agregarHistoria","userStoryData","existeHistoria","micro_servicio","exportarJson","dataStr","stringify","dataUri","encodeURIComponent","exportFileDefaultName","linkElement","createElement","setAttribute","App"],"sources":["C:/visualizacion_microservicios/src/App.js"],"sourcesContent":["//************* Imports *****************/\nimport React from 'react';\nimport * as go from 'gojs';\nimport '../node_modules/gojs/extensions/Figures'\nimport { Inspector } from '../node_modules/gojs/extensionsJSM/DataInspector.js'\nimport './css/App.css';  // contains .diagram-component CSS\nimport swal from 'sweetalert'\n\n//************ Variables ****************/\n\nvar myDiagram;\nvar nodos = [];\nvar aristas = [];\nvar diagramaCargado = false;\nvar json;\nvar userStory = [];\nvar proximoMS = \"\";\nvar CantidadMSs = 0;\n\nvar AIST = 0; // Acoplamiento AIS total\nvar ADST = 0; // Acoplamiento ADS total\nvar SIYT = 0; // Acoplamiento SIY total\nvar CpT = 0;  // Acoplamiento total de la aplicación\n\nvar Coh = 0;  // Cohesion grade total\nvar CohT = 0; // Cohesión total de la aplicación\n\nvar WsicT = 0;// mayor número de historias de usuario asociadas a un microservicio\n//var CxT = 0;  // Complejidad cognitiva total de la aplicación\nvar SsT = 0;  // Similitud semántica total de la aplicación\n/*\n𝑀𝑆𝐵𝐴=(𝑀𝑆, 𝑀𝑇 ⃗) \nDonde:\n𝑀𝑆𝐵𝐴 = MicroServices Based Application\nMS es un conjunto de microservicios MS = {ms1, ms2, …, msn} \n𝑀𝑇 ⃗ es un vector de métricas calculadas para MSBA\n\n𝑀𝑇 ⃗=[𝐶𝑝𝑇, 𝐶𝑜ℎ𝑇, 𝑊𝑠𝑖𝑐𝑇, 𝐶𝑥𝑇,(100− 𝑆𝑠𝑇)]\nDonde:\nCpT es el acoplamiento, \nCohT es la cohesión, \nWsicT es el mayor número de historias de usuario asociadas a un microservicio, \nCxT son los puntos de complejidad cognitiva, y \nSsT es la similitud semántica; Las cuales son métricas calculadas para MSBA\n*/\n\n/* Cx = (sum(c𝑔)) + maxMSpoints + (CantidadMSs*WsicT) + (sum(Pf)) + (sum(SIY)) */ \nvar maxMSpoints = 0;\n//var Pf = 0; // Número (máximo?) de llamadas secuenciales entre microservicios\n\n/* CxT = Cx / Cxo */\n\n//************ Funciones ****************/\n\nfunction convertir_jsonAnodos() {\n\n  AIST = 0;\n  ADST = 0;\n  SIYT = 0;\n  CpT = 0;\n  Coh = 0;\n  CohT = 0;\n  WsicT = 0;\n  SsT = 0;\n  CantidadMSs = 0;\n  maxMSpoints = 0;\n  nodos = [];\n  aristas = [];\n\n  for (let i = 0; i < Object(json).length; i++) {\n    var MSdependencias = [];\n    var MScalls = [];\n    var MSpuntos = 0;\n    for (let j = 0; j < Object(json[i].userStories).length; j++) {\n      MSpuntos = MSpuntos + json[i].userStories[j].points;\n      if (Object(json[i].userStories).length > WsicT) {\n        WsicT = Object(json[i].userStories).length;\n      };\n      nodos = nodos.concat({\n        actor: json[i].userStories[j].actor,\n        componente: \"historia\",\n        dependencies: json[i].userStories[j].dependencies,\n        group: json[i].id,\n        id: json[i].userStories[j].id,\n        key: json[i].userStories[j].id,\n        name: json[i].userStories[j].name,\n        priority: json[i].userStories[j].priority,\n        project: json[i].userStories[j].project,\n        points: json[i].userStories[j].points\n      });\n      for (let k = 0; k < Object(json[i].userStories[j].dependencies).length; k++) {\n        aristas = aristas.concat({\n          from: json[i].id,\n          // eslint-disable-next-line\n          to: (function () {\n            for (let l = 0; l < Object(json).length; l++) {\n              for (let m = 0; m < Object(json[l].userStories).length; m++) {\n                if (json[i].userStories[j].dependencies[k] === json[l].userStories[m].id) {\n                  if (json[i].id !== json[l].id) { // Si son diferentes MS's se asigna el valor a 'to'.\n                    MScalls = MScalls.concat(json[l].id);\n                    return json[l].id;\n                  }\n                }\n              }\n            }\n          })()\n        });\n      }\n    }\n\n    /* Hacer este filter abajo si se quieren mostrar las dependencias repetidas en el Inspector*/\n    // eslint-disable-next-line\n    MSdependencias = MScalls.filter((item, index) => {// Quita las dependencias repetidas\n      return MScalls.indexOf(item) === index;\n    })\n\n    if (json[i].userStories.length !== 0) {\n      CantidadMSs++;\n      nodos = nodos.concat({\n        calls: MScalls.length,\n        cg: 0,\n        coupling_AIS: 0,\n        coupling_ADS: MSdependencias.length,\n        coupling_SIY: 0,\n        cohesion_lack: 0,\n        cohesion_grade: 0,\n        columnas: Math.ceil(Math.sqrt(json[i].userStories.length)),\n        complexity: json[i].complexity,\n        componente: \"microservicio\",\n        dependencies: MSdependencias, // o 'MScalls' si quiere mostrar repetidos \n        isGroup: true,\n        id: json[i].id,\n        key: json[i].id,\n        points: MSpuntos,\n        requests: 0,\n        semantic_similarity: json[i].semantic_similarity,\n        //size: 45 + (json[i].userStories.length * 12),\n        size: 45 + (MSpuntos * 12),\n        textoID: 0.23 - ((((45 + (json[i].userStories.length * 12)) - 57) * 0.12) / 100),\n        userStories: json[i].userStories.length\n      });\n    }\n    ADST = ADST + Math.pow(MSdependencias.length, 2) // Sumatoria de los cuadrados\n  };\n  \n\n  var historias = nodos.filter((nodo) => nodo.componente === \"historia\");\n  historias = historias.map((nodo) => nodo.id);\n  console.log(historias);\n\n  // Quitar las aristas con 'to' undefined\n  aristas = aristas.filter((item) => item.to !== undefined);\n\n  var rendimiento = 0;\n\n  // Cálculo de los acomplamientos AIS y SIY\n  for (let i = 0; i < nodos.length; i++) {\n    if (nodos[i].componente === \"microservicio\") {\n      var LC = CantidadMSs - 1; // Cohesion Lack\n\n      // Cálculo del acomplamiento AIS (Cantidad de aristas que le entran)\n      var MSrequests = [];\n      var MSimportancia = [];\n      for (let j = 0; j < aristas.length; j++) {\n        if (nodos[i].id === aristas[j].to) {\n          MSrequests = MSrequests.concat(aristas[j].from);\n        }\n      }\n      // eslint-disable-next-line\n      MSimportancia = MSrequests.filter((item, index) => {// Quita las importancias\n        return MSrequests.indexOf(item) === index;      // repetidas\n      })\n      nodos[i].requests = MSrequests.length;\n      nodos[i].coupling_AIS = MSimportancia.length;\n      AIST = AIST + Math.pow(MSimportancia.length, 2); // Sumatoria de los cuadrados\n\n      // Cálculo del acomplamiento SIY (interdependencias / cantidad de MS's)\n      var interdependencias = [];\n      // eslint-disable-next-line\n      var interdepA = nodos[i].dependencies.filter((item, index) => {// Quita las depen-\n        return nodos[i].dependencies.indexOf(item) === index;// dencias(1) repetidas\n      })\n      for (let j = 0; j < interdepA.length; j++) { // para comparar cada dependencia(1)\n        for (let k = 0; k < nodos.length; k++) { // Inicia de nuevo en todos los nodos\n          if (nodos[k].componente === \"microservicio\") { // solo los nodos MS's\n            // eslint-disable-next-line\n            var interdepB = nodos[k].dependencies.filter((item, index) => {\n              return nodos[k].dependencies.indexOf(item) === index;\n            }) // Quita las dependencias(2) repetidas\n            if (interdepA[j] === nodos[k].id) { // Compara dependencias(1) con IDs de MS\n              for (let l = 0; l < interdepB.length; l++) {\n                if (interdepB[l] === nodos[i].id) { // Compara dependencias(2) con IDs de MS\n                  interdependencias = interdependencias.concat(nodos[k].id);\n                  LC--;\n                }\n              }\n            }\n          }\n        }\n      }\n      var SIY = (interdependencias.length / CantidadMSs)\n      nodos[i].coupling_SIY = SIY.toFixed(2);\n      SIYT = SIYT + Math.pow(SIY, 2); // Sumatoria de los cuadrados\n\n      // Cálculo de Cohesion Lack  y Grade\n      nodos[i].cohesion_lack = LC;\n      Coh = LC / CantidadMSs;\n      nodos[i].cohesion_grade = Coh.toFixed(2);\n      CohT = CohT + Math.pow(Coh, 2); // Sumatoria de los cuadrados\n\n      // Cálculo de la similitud semántica\n      SsT = SsT + nodos[i].semantic_similarity // Sumatoria previa\n\n      /*        Otros         */\n      rendimiento = rendimiento + nodos[i].calls;\n      // cg = MSpuntos * (MScalls + MSrequests)\n      nodos[i].cg = nodos[i].points * (nodos[i].calls + MSrequests.length);\n      console.log(nodos[i].id + \".cg: \" + nodos[i].cg.toFixed(2));\n      //\n      if (nodos[i].points > maxMSpoints) {\n        maxMSpoints = nodos[i].points;\n      }\n    }\n  }\n  AIST = Math.sqrt(AIST);\n  ADST = Math.sqrt(ADST);\n  SIYT = Math.sqrt(SIYT);\n  CpT = Math.sqrt(Math.pow(AIST, 2) + Math.pow(ADST, 2) + Math.pow(SIYT, 2));\n  CohT = Math.sqrt(CohT);\n  SsT = SsT * (100 / CantidadMSs);\n\n  /*          Otros           */\n  rendimiento = rendimiento / CantidadMSs;\n  console.log(\"Rendimiento: \" + rendimiento.toFixed(2));\n  console.log(\"Max ponits: \" + maxMSpoints.toFixed(2));\n\n  diagramaCargado = true;\n  init();\n}\n\nfunction convertir_nodosAjson(nodosAjson) {\n  json = [];\n  var hu = [];\n  var microservicios = [];\n  microservicios = nodosAjson.filter((item) => item.componente === 'microservicio')\n\n  for (let i = 0; i < Object(microservicios).length; i++) {\n    hu = nodosAjson.filter((item) => (\n      item.componente === 'historia' && item.group === microservicios[i].key\n    ))\n    json = json.concat({\n      \"cohesion_lack\": microservicios[i].cohesion_lack,\n      \"cohesion_grade\": microservicios[i].cohesion_grade,\n      \"complexity\": microservicios[i].complexity,\n      \"id\": microservicios[i].key,\n      \"points\": microservicios[i].points,\n      \"semantic_similarity\": microservicios[i].semantic_similarity,\n      \"userStories\": hu\n    });\n  }\n}\n\nfunction nuevoMSid() { // Retorna un nuevo ID no usado en el diagrama\n  proximoMS = \"\";\n  var MSs = nodos.filter((nodo) => {\n    return nodo.componente === \"microservicio\"\n  })\n  var nombres = MSs.map((nodo) => {\n    return nodo.id.replace(\"MS\", \"\");\n  })\n  nombres.sort();\n  var nums = nombres.map(function (str) {\n    return parseInt(str);\n  });\n  for (let i = 1; i < nums.length + 2; i++) {\n    if (i !== nums[i - 1]) {\n      proximoMS = \"MS\" + i;\n      return proximoMS;\n    }\n  }\n}\n\nfunction crearMicroservicio(ms, us) {\n  json = json.concat({\n    \"cohesion_lack\": 0,\n    \"cohesion_grade\": 0,\n    \"complexity\": 0,\n    \"id\": ms,\n    \"points\": 0,\n    \"semantic_similarity\": 0,\n    \"userStories\": us\n  });\n}\n\nfunction formatearUS(historia) {\n  var historiaFormateada = [\n    {\n      \"id\": historia.id,\n      \"name\": historia.name,\n      \"actor\": historia.actor,\n      \"points\": historia.points,\n      \"project\": historia.project,\n      \"priority\": historia.priority,\n      \"dependencies\": historia.dependencies\n    }\n  ]\n  return historiaFormateada;\n}\n\nfunction quitarUSdeMS(ms, us) {\n  for (let i = 0; i < Object(json).length; i++) {\n    if (json[i].id === ms) {\n      for (let j = 0; j < json[i].userStories.length; j++) {\n        if (json[i].userStories[j].id === us[0].id) {\n          json[i].userStories.splice(j, 1);\n          return;\n        }\n      }\n      return;\n    }\n  }\n}\n\nfunction init() {\n  const $ = go.GraphObject.make;\n  // set your license key here before creating the diagram: go.Diagram.licenseKey = \"...\";\n  myDiagram = $(go.Diagram, \"myDiagramDiv\", { // create a Diagram for the DIV HTML element       \n    \"animationManager.initialAnimationStyle\": go.AnimationManager.AnimateLocations,\n    //autoScale: go.Diagram.Uniform,  // scale always has all content fitting in the viewport\n\n    // decide what kinds of Parts can be added to a Group or to top-level\n    \"commandHandler.memberValidation\": (grp, node) => {\n      if (grp != null) { // maybe allow dropping groups in diagram's background\n        if (node instanceof go.Group) { // No deja agregar un grupo a otro grupo\n          return false;\n        }\n        return true;\n      }\n    },\n    \"undoManager.isEnabled\": true, // Habilita deshacer y rehacer\n    contentAlignment: go.Spot.Center,  // Centra el contenido en el viewport (ventana gráfica)\n    isReadOnly: false,  // No permite modificar\n    mouseDrop: (e, grp) => { // Devuelve al nodo a su posición original cuando se arrastra afuera\n      var nodoSeleccionado = myDiagram.selection; // Guarda el US seleccionado\n      var nuevaHistoria = formatearUS(nodoSeleccionado.ea.key.qb);\n      try {\n        var MSnombre = nodoSeleccionado.ea.key.qb.group; // Nombre del grupo\n        var MScompleto = e.diagram.findNodeForKey(MSnombre);\n        if (MScompleto.qb.userStories > 1) {\n          var proximo = nuevoMSid(); // Crea un nuevo id de MS no repetido\n\n          quitarUSdeMS(MSnombre, nuevaHistoria);\n          crearMicroservicio(proximo, nuevaHistoria); // Crea nuevo MS y le asigna el id recién creado\n\n\n          //convertir_nodosAjson(nodos);\n\n          nuevoDiagrama();\n        } else {\n          myDiagram.currentTool.doCancel();\n        }\n      } catch (error) {\n\n      }\n    },\n    mouseDragOver: function () {\n      myDiagram.currentCursor = \"grabbing\";\n      myDiagram.clearHighlighteds();\n    },\n    click: function () {\n      myDiagram.currentCursor = \"grabbing\";\n      myDiagram.clearHighlighteds();\n    }\n  });\n\n  myDiagram.groupTemplate = $(go.Group, \"Vertical\", { // 'Vertical' Pone el nombre del nodo arriba    \n    deletable: false, // No permite borrar el grupo\n    copyable: false,\n    //isActionable: true,\n    handlesDragDropForMembers: true,  // don't need to define handlers on Nodes and Links\n    computesBoundsAfterDrag: true  // Permite arrastrar la historia fuera del\n    // microservicio sin deformarlo\n\n  },\n    {\n      mouseOver: function (e) {\n        e.diagram.currentCursor = \"grab\";\n      },\n\n      // Para cambiar el fill (color) cuando el cursor entra o sale\n      mouseEnter: function (e, obj) {\n        var microservicio = obj.findObject(\"MICROSERVICIO\");\n        microservicio.fill = \"rgb(68, 100, 66)\";\n        obj.currentCursor = \"hand\";\n      },\n      mouseLeave: function (e, obj) {\n        var microservicio = obj.findObject(\"MICROSERVICIO\");\n        microservicio.fill = \"rgba(125, 200, 120, .6)\";\n      },\n      click: function (e, node) {\n        var diagram = node.diagram;\n        // remove any previous highlighting\n        diagram.clearHighlighteds();\n        // highlight all Links and Nodes coming out of a given Node\n        diagram.startTransaction(\"highlight\");\n        //diagram.clearHighlighteds();\n        // for each Link coming out of the Node, set Link.isHighlighted\n        node.findLinksOutOf().each(function (l) { l.isHighlighted = true; });\n        // for each Node destination for the Node, set Node.isHighlighted\n        node.findNodesOutOf().each(function (n) { n.isHighlighted = true; });\n        diagram.commitTransaction(\"highlight\");\n      },\n\n      // what to do when a drag-over or a drag-drop occurs on a Group\n      mouseDragEnter: (e, grp, prev) => {\n        if (grp.canAddMembers(grp.diagram.toolManager.draggingTool.draggingParts)) {\n          const shape = grp.findObject(\"MICROSERVICIO\");\n          if (shape) {\n            shape.fill = \"chartreuse\";\n          }\n          grp.diagram.currentCursor = \"\";\n        } else {\n          grp.diagram.currentCursor = \"no-drop\";\n        }\n      },\n      mouseDragLeave: (e, grp, next) => {\n        const shape = grp.findObject(\"MICROSERVICIO\");\n        if (shape) {\n          shape.fill = \"rgba(125, 200, 120, .6)\";\n        }\n        grp.diagram.currentCursor = \"\";\n      },\n      mouseDrop: (e, grp) => {\n        const ok = grp.addMembers(grp.diagram.selection, true);\n        if (!ok) {\n          grp.diagram.currentTool.doCancel();\n          return;\n        }\n        convertir_nodosAjson(nodos);\n        nuevoDiagrama();\n      }\n    },\n    new go.Binding(\"layout\", \"columnas\", function (c) {\n      return $(go.GridLayout, {\n        wrappingColumn: c, // Determina cantidad de columnas\n        cellSize: new go.Size(0, 0), // Determina ancho de columnas\n        spacing: new go.Size(0, 0) // Determina espacio entre columnas\n      });\n    }),\n    // Inhabilitar el movimiento de los nodos resaltados:\n    //new go.Binding(\"isActionable\", \"isHighlighted\", function (h) {\n    //return h ? true : false;\n    //}).ofObject(),\n    $(go.Panel, \"Spot\",\n      //$(go.Shape, \"Hexagon\", {\n      $(go.Shape, \"Cube1\", {\n        name: \"MICROSERVICIO\",\n        fill: \"rgba(125, 200, 120, .6)\"\n      },\n        new go.Binding(\"stroke\", \"isHighlighted\", function (h) {\n          return h ? \"red\" : null;\n        }).ofObject(),\n        new go.Binding(\"stroke\", \"isSelected\", function (h) {\n          return h ? \"rgb(30,144,255)\" : null;\n        }).ofObject(),\n        new go.Binding(\"strokeWidth\", \"isHighlighted\", function (h) {\n          return h ? 2 : 3;\n        }).ofObject(),\n        new go.Binding(\"width\", \"size\"), // Asigna al ancho el valor de size\n        new go.Binding(\"height\", \"size\") // Asigna a la altura el valor de size\n      ), $(go.TextBlock, \"text\",\n        new go.Binding(\"text\", \"key\"), // Asigna al texto el valor de key\n        new go.Binding(\"alignment\", \"textoID\", function (c) {\n          return new go.Spot(0.5, c); // Asigna valor a Y en la posición del\n        }),\n      ),\n      $(go.Placeholder, { // Centra las HUs en el hexágono del microservicio\n        padding: 1\n      })\n    )\n  );\n\n  myDiagram.nodeTemplate = $(go.Node, \"Auto\", { // 'Auto' Ajusta el tamaño del elemento según sus subelementos. \n    locationSpot: go.Spot.Center,\n    copyable: false,\n    deletable: false // No permite borrar el nodo\n  },\n    {\n      mouseOver: function (e, node) {\n        e.diagram.currentCursor = \"grab\";\n      },\n\n      // Para cambiar el fill (color) cuando el cursor entra o sale\n      mouseEnter: function (e, obj) {\n        var microservicio = obj.findObject(\"HISTORIA\");\n        microservicio.fill = \"gray\";\n        obj.currentCursor = \"hand\";\n      },\n      mouseLeave: function (e, obj) {\n        var microservicio = obj.findObject(\"HISTORIA\");\n        microservicio.fill = \"white\";\n      },\n      click: function (e, node) {\n        var diagram = node.diagram;\n        // remove any previous highlighting\n        diagram.clearHighlighteds();\n      }\n    },\n    $(go.Shape, \"RoundedRectangle\", {\n      name: \"HISTORIA\",\n      fill: \"white\"\n    }),\n    $(go.TextBlock, \"text\",\n      new go.Binding(\"text\", \"key\") // Asigna al texto el valor de key\n    )\n  );\n\n  myDiagram.linkTemplate = $(go.Link, {\n    curve: go.Link.Bezier,\n    reshapable: true,\n    deletable: false // No permite borrar la flecha\n  },\n    // No necesita guardar Link.points, por lo que no necesita TwoWay Binding en \"puntos\"\n    new go.Binding(\"curviness\", \"curviness\").makeTwoWay(),  // pero guarda \"curvas\" automáticamente\n    $(go.Shape, { // Características del cuerpo de la flecha       \n      strokeWidth: 2,\n    },\n      new go.Binding(\"stroke\", \"isHighlighted\", function (h) {\n        return h ? \"red\" : \"black\";\n      }).ofObject(),\n    ),\n    $(go.Shape, { // Características de la cabeza de la flecha  \n      toArrow: \"standard\", // Forma de la cabeza de la flecha  \n      stroke: \"white\" // Borde de la cabeza de flecha\n    })\n  );\n\n  // Crea el modelo del diagrama a mostrar\n  myDiagram.model = new go.GraphLinksModel(nodos, aristas);\n\n  // some shared model data\n  myDiagram.model.modelData = {\n    \"AIST:\": AIST.toFixed(2),\n    \"ADST:\": ADST.toFixed(2),\n    \"SIYT:\": SIYT.toFixed(2),\n    \"CpT:\": CpT.toFixed(2),\n    \"CohT:\": CohT.toFixed(2),\n    \"SsT:\": SsT.toFixed(2),\n    \"WsicT\": WsicT\n  };\n\n  /* Declare which properties to show and how.\n  By default, all properties on the model data objects are shown unless \n  the inspector option \"includesOwnProperties\" is set to false. */\n\n  // Show the primary selection's data, or blanks if no Part is selected:\n  // eslint-disable-next-line\n  var inspector = new Inspector('myInspectorDiv', myDiagram, {\n    //showAllProperties: true,\n    // Inspect the named properties below instead of all properties on each object \n    includesOwnProperties: false,\n    inspectSelection: true,\n    properties: {\n      // key would be automatically added for nodes, but we want to declare it read-only also:\n      \"id\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n        /*show: function (data, propname) {\n          if (data instanceof go.Part) data = data.data;\n          return typeof data === \"object\" && data[propname] !== undefined;\n        }*/\n      },\n      \"points\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"dependencies\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"coupling_AIS\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"coupling_ADS\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"coupling_SIY\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"cohesion_lack\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"cohesion_grade\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"complexity\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"semantic_similarity\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"actor\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"group\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"name\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"priority\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      },\n      \"project\": {\n        readOnly: true,\n        show: Inspector.showIfPresent\n      }\n    }\n  });\n\n  // Always show the model.modelData:\n  var inspector2 = new Inspector('myInspectorDiv2', myDiagram, {\n    inspectSelection: false\n  });\n  inspector2.inspectObject(myDiagram.model.modelData);\n\n\n} // end Init\n\nfunction validarJson(schema, jsonCargado) {\n  const Ajv = require(\"ajv\")\n  const ajv = new Ajv({ allErrors: true })\n  const validate = ajv.compile(schema)\n  const valid = validate(jsonCargado)\n  if (!valid) {\n    console.log(validate.errors);\n    swal({\n      title: \"Invalid schema\",\n      icon: \"error\",\n      timer: 2000\n    })\n    return false;\n  } else {\n    return true;\n  }\n}\n\nexport function LeerArchivo(e) {\n  var archivo = e.target.files[0];\n  if (!archivo) {\n    return;\n  }\n  if (diagramaCargado) {\n    myDiagram.div = null;\n    myDiagram = null;\n  }\n  json = [];\n  var lector = new FileReader();\n  lector.onload = function (e) {\n    var jsonData = e.target.result;\n    json = JSON.parse(jsonData);\n    var schema = require('./schemas/microservices.json');\n    var esValido = validarJson(schema, json);\n    if (esValido) {\n      convertir_jsonAnodos();\n    }\n  };\n  lector.readAsText(archivo);\n  document.getElementById(\"miInput\").value = null;\n}\n\nfunction formatearDependencias() { // Quita los nombres de las dependencias y las\n  var dependencias = [];           // deja como un arreglo de strings (historias)\n  for (let i = 0; i < userStory[0].dependencies.length; i++) {\n    dependencias = dependencias.concat(userStory[0].dependencies[i].id);\n  }\n  userStory[0].dependencies = dependencias;\n}\n\nfunction verificarHistoria() {   // Verifica la existencia de una historia de usuario \n  try {\n    var story = userStory[0].id;   // en un diagrama de microservicios\n    var contador = 0;\n    for (let i = 0; i < json.length; i++) {\n      for (let j = 0; j < json[i].userStories.length; j++) {\n        if (json[i].userStories[j].id === story) {\n          swal({\n            title: \"The story \" + story + \" is already in the project\",\n            text: \"Do you wish to include other stories?\",\n            icon: \"warning\",\n            buttons: ['Cancel', 'Accept']\n          }).then(respuesta => {\n            if (respuesta) {\n              swal({\n                title: \"The rest of the stories were included succesfully\",\n                icon: \"success\",\n                timer: 1500\n              })\n            }\n          })\n          contador++;\n        }\n      }\n    }\n    if (contador > 0) {\n      return true;\n    }\n    formatearDependencias();\n    swal({\n      title: \"Stories included succesfully\",\n      icon: \"success\",\n      timer: 1500\n    })\n    return false;\n  } catch (error) {\n    swal({\n      title: \"Formato de json incompatible\",\n      icon: \"error\",\n      timer: 1500\n    })\n  }\n}\n\nfunction quitarGuionesMedios(us) {\n  for (let i = 0; i < us.length; i++) {\n    us[i].id = us[i].id.replace(\"-\", \"\");\n    for (let j = 0; j < us[i].dependencies.length; j++) {\n      us[i].dependencies[j].id = us[i].dependencies[j].id.replace(\"-\", \"\");\n    }\n  }\n  return us;\n}\n\nfunction agregarHistoria(e) {\n  if (diagramaCargado) {\n    var archivo = e.target.files[0];\n    if (!archivo) {\n      return;\n    }\n    var lector = new FileReader();\n    lector.onload = function (e) {\n      var userStoryData = e.target.result;\n      userStory = JSON.parse(userStoryData)\n      var schema = require('./schemas/userStories.json');\n      var esValido = validarJson(schema, userStory);\n      if (esValido) {\n        userStory = quitarGuionesMedios(userStory);\n        var existeHistoria = verificarHistoria();\n        if (!existeHistoria) {\n          var micro_servicio = nuevoMSid();\n          crearMicroservicio(micro_servicio, userStory);\n          nuevoDiagrama();\n        }\n      }\n    };\n    lector.readAsText(archivo);\n  } else {\n    swal({\n      title: \"Cargue un diagrama primero\",\n      icon: \"error\",\n      timer: 2000\n    })\n  }\n  document.getElementById(\"miInput2\").value = null;\n}\n\nfunction exportarJson() {\n  if (diagramaCargado) {\n    var dataStr = JSON.stringify(json);\n    var dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);\n\n    var exportFileDefaultName = 'data.json'; // Asigna un nombre al archivo\n\n    var linkElement = document.createElement('a');\n    linkElement.setAttribute('href', dataUri);\n    linkElement.setAttribute('download', exportFileDefaultName);\n    linkElement.click();\n  } else {\n    swal({\n      title: \"Cargue un diagrama primero\",\n      icon: \"error\",\n      timer: 2000\n    })\n  }\n}\n\nfunction nuevoDiagrama() {\n  if (diagramaCargado === true) {\n    myDiagram.div = null;\n    myDiagram = null;\n  }\n  convertir_jsonAnodos();\n  diagramaCargado = true;\n}\n\n// render function...\nexport function App() {\n  return (\n    <div>\n      <span id='spanEncabezado'>\n        <div id=\"encabezado\"></div>\n      </span>\n      <span className='spanInspector'>\n        <div className=\"fondoInspector\">\n          <div id='inputsDiv'>\n            <div className=\"file-select\" id=\"src-file1\" >\n              <input onInput={LeerArchivo} className='boton' type=\"file\" id='miInput' />\n            </div>\n            <div className=\"file-select\" id=\"src-file2\" >\n              <input onInput={agregarHistoria} className='boton' type=\"file\" id='miInput2' />\n            </div>\n            <div className=\"file-select\" id=\"src-file3\" >\n              <button onClick={exportarJson} className='boton' type=\"button\" id='miInput3' />\n            </div>\n          </div>\n          <h3 id=\"informacion\">INFORMATION:</h3>\n          <div id=\"myInspectorDiv\" className=\"inspector\">\n          </div>\n        </div>\n      </span>\n      <span id='spanDiagram'>\n        <div id='myDiagramDiv'></div>\n      </span>\n      <span className='spanInspector'>\n        <div className=\"fondoInspector\">\n          <h3 id=\"informacion\">APP METRICS:</h3>\n          <div id=\"myInspectorDiv2\" className=\"inspector\">\n          </div>\n        </div>\n      </span>\n    </div>\n  );\n}\n\n//function mostrarContenido(contenido) {\n//  var elemento = document.getElementById('contenido-archivo');\n//  elemento.innerHTML = contenido; // Inyecta un contenido a un elemento HTML en la página\n//}\n\n//<script>\n//addEventListener = {document.addEventListener('change', LeerArchivo, false)}\n//</script>\n\n\n//export default App\n\n// Si se habilita esta línea, se ejecuta la función Init cuando el HTML carga el script\n//window.addEventListener('DOMContentLoaded', Init);\n\n//export default LeerArchivo;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}